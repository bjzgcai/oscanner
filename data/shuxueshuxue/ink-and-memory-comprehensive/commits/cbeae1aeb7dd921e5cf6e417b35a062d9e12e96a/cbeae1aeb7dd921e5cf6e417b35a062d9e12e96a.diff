commit cbeae1aeb7dd921e5cf6e417b35a062d9e12e96a
Author: lexicalmathical <lexicalmathical@gmail.com>
Date:   Sat Oct 4 10:17:52 2025 +0800

    Clean up code after fixing dynamic triggers
    
    - Remove all debug console.log statements
    - Remove commented example code
    - Keep only the working solution for dynamic trigger updates
    
    ðŸ¤– Generated with Claude Code
    
    Co-Authored-By: Claude <noreply@anthropic.com>

diff --git a/frontend/src/App.tsx b/frontend/src/App.tsx
index 7e54635..a787be2 100644
--- a/frontend/src/App.tsx
+++ b/frontend/src/App.tsx
@@ -74,17 +74,6 @@ function App() {
     setVoiceTriggers(newTriggers);
   };
 
-  // Example usage (uncomment to test):
-  // setTimeout(() => {
-  //   addTrigger({
-  //     phrase: 'remember when',
-  //     voice: 'Nostalgia',
-  //     comment: 'The past always seems brighter from here...',
-  //     color: 'purple',
-  //     icon: 'cloud',
-  //   });
-  // }, 3000);
-
   // Expose methods to window for testing in console
   useEffect(() => {
     (window as any).voiceControls = {
@@ -94,7 +83,6 @@ function App() {
       setAllTriggers,
       getCurrentTriggers: () => voiceTriggers,
     };
-    console.log('Voice controls available! Try: window.voiceControls.addTrigger({...})');
   }, [voiceTriggers]);
 
   return (
diff --git a/frontend/src/components/EditableTextArea.tsx b/frontend/src/components/EditableTextArea.tsx
index c5b8cdb..c7a9cc7 100644
--- a/frontend/src/components/EditableTextArea.tsx
+++ b/frontend/src/components/EditableTextArea.tsx
@@ -21,8 +21,8 @@ export default function EditableTextArea({ onChange, triggers }: EditableTextAre
   // @@@ Dynamic trigger updates - Update highlights when triggers change
   useEffect(() => {
     if (editor && editor.isEditable) {
-      // Force recalculation by triggering a transaction with meta
-      const { tr } = editor.state;
+      // Force recalculation by creating a new transaction with meta
+      const tr = editor.state.tr;
       tr.setMeta('voiceHighlight', { triggers });
       editor.view.dispatch(tr);
     }
diff --git a/frontend/src/extensions/VoiceHighlight.ts b/frontend/src/extensions/VoiceHighlight.ts
index ffdc5a7..88a0f19 100644
--- a/frontend/src/extensions/VoiceHighlight.ts
+++ b/frontend/src/extensions/VoiceHighlight.ts
@@ -14,7 +14,6 @@ export interface VoiceHighlightOptions {
   triggers: VoiceTrigger[];
 }
 
-// Dynamic voice highlighting with real-time updates
 export const VoiceHighlight = Extension.create<VoiceHighlightOptions>({
   name: 'voiceHighlight',
 
@@ -40,16 +39,17 @@ export const VoiceHighlight = Extension.create<VoiceHighlightOptions>({
             // @@@ Dynamic updates - Recalculate on doc change or meta change
             const metaChanged = tr.getMeta('voiceHighlight');
             if (metaChanged?.triggers) {
-              triggers = metaChanged.triggers;
+              const newTriggers = metaChanged.triggers;
               return {
-                decorations: findHighlights(tr.doc, triggers),
-                triggers
+                decorations: findHighlights(tr.doc, newTriggers),
+                triggers: newTriggers
               };
             }
             if (tr.docChanged) {
+              const currentTriggers = oldState.triggers || triggers;
               return {
-                decorations: findHighlights(tr.doc, oldState.triggers || triggers),
-                triggers: oldState.triggers || triggers
+                decorations: findHighlights(tr.doc, currentTriggers),
+                triggers: currentTriggers
               };
             }
             return oldState;
