commit 686157161fca772b3dd3a6854410944d4852e6ba
Author: lexicalmathical <lexicalmathical@gmail.com>
Date:   Sun Nov 2 15:03:55 2025 +0800

    Remove unused legacy code and test files
    
    Deleted frontend components (7 files, ~500 lines):
    - BinderRing.tsx, BinderRings.tsx (decorative UI, unused)
    - BookPage.tsx (unused UI component)
    - CalendarView.tsx (replaced by CollectionsView timeline)
    - CalendarWidget.tsx (unused calendar component)
    - VoiceComment.tsx (replaced by inline comment system)
    - VoicesPanel.tsx (unused panel)
    
    Deleted backend files (5 files, ~400 lines):
    - server_old.py (old stateless server implementation)
    - test_migration.py, test_real_migration.py (one-time migration tests)
    - archive/vibe-coding-scraper-example/ (old example code)
    - test_data/ (test data no longer needed)
    
    Build verified passing. Bundle size unchanged (341.78 kB).
    
    ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
    
    Co-Authored-By: Claude <noreply@anthropic.com>

diff --git a/backend/archive/vibe-coding-scraper-example/README.md b/backend/archive/vibe-coding-scraper-example/README.md
deleted file mode 100644
index 16fc67a..0000000
--- a/backend/archive/vibe-coding-scraper-example/README.md
+++ /dev/null
@@ -1,66 +0,0 @@
-# Vibe-Coding Web Scraper Example
-
-## The Process
-
-This documents a real example of "vibe-coding" - rapid iterative development through observe-code-observe-code cycles.
-
-### The Goal
-Scrape 24 Disco Elysium skill pages to extract personality descriptions for inner voice archetypes.
-
-### The Wrong Way (Initial Attempt)
-```
-‚ùå Write complete scraper without looking at target
-‚ùå Add complex parsing logic upfront
-‚ùå Over-engineer before testing
-```
-
-### The Right Way (Vibe-Coding)
-```
-‚úÖ Look at page structure first (WebFetch on Logic page)
-‚úÖ Look at another page to confirm pattern (Inland Empire)
-‚úÖ Write minimal scraper
-‚úÖ Run and observe
-‚úÖ Iterate if needed
-```
-
-### Key Lesson
-
-**"You are just wasting time. Correct scraping workflow is observe-code-observe-code... you are coding too much without even look at the target page's structure"**
-
-The vibe-coding approach:
-1. Observe (fetch a sample page)
-2. Code (minimal scraper)
-3. Observe (run it, see results)
-4. Code (adjust if needed)
-
-Fast iteration beats perfect planning.
-
-### The Conversation Flow
-
-1. **User**: "let's digress to scrape the corresponding pages for each of these skills to form an easy-to-use reference folder"
-
-2. **Assistant** (wrong): Writes complex scraper without looking at pages first
-
-3. **User** (intervention): "you are just wasting time. correct scraping workflow is observe-code-observe-code..."
-
-4. **Assistant** (corrected): Uses WebFetch to check Logic page structure
-
-5. **User** (intervention again): "why look at so much?"
-
-6. **Assistant** (finally right): Minimal scraper, just run it
-
-7. **Result**: Working scraper in ~20 lines that collected all 24 skills
-
-### Time Saved
-- Wrong approach: Would have taken 30+ minutes of debugging
-- Vibe-coding: Done in 5 minutes
-
-### Code
-See `scraper.py` for the minimal working implementation.
-
-### Results
-See `disco_skills.json` for the scraped data (24 skills with descriptions).
-
----
-
-**Takeaway**: When scraping, don't overthink. Look once, code minimal, run fast.
diff --git a/backend/archive/vibe-coding-scraper-example/disco_skills.json b/backend/archive/vibe-coding-scraper-example/disco_skills.json
deleted file mode 100644
index 3d334b6..0000000
--- a/backend/archive/vibe-coding-scraper-example/disco_skills.json
+++ /dev/null
@@ -1,98 +0,0 @@
-{
-  "Logic": {
-    "name": "Logic",
-    "description": "Logic\n\n\n\n\n\n\nDetails\n\nAttribute\nIntellect\n\n\n\nNavigation\n\nNext Skill\nEncyclopedia\n\n\n\nLogic is a skill under the Intellect attribute in Disco Elysium.\n\nWield raw intellectual power. Deduce the world.\n\nCool for: Analysts, Pure Rationalists, Obviously Logicians."
-  },
-  "Encyclopedia": {
-    "name": "Encyclopedia",
-    "description": "Encyclopedia\n\n\n\n\n\n\nDetails\n\nAttribute\nIntellect\n\n\n\nNavigation\n\nPrevious Skill\nLogic\n\n\nNext Skill\nRhetoric\n\n\n\nEncyclopedia is a skill under the Intellect attribute in Disco Elysium.\n\nCall upon all your knowledge. Produce fascinating trivia.\n\nCool for: Thinkers, Historians, Trivia Freaks"
-  },
-  "Rhetoric": {
-    "name": "Rhetoric",
-    "description": "Rhetoric\n\n\n\n\n\n\nDetails\n\nAttribute\nIntellect\n\n\n\nNavigation\n\nPrevious Skill\nEncyclopedia\n\n\nNext Skill\nDrama\n\n\n\nRhetoric is a skill under the Intellect attribute in Disco Elysium.\n\nPractice the art of persuasion. Enjoy rigorous intellectual discourse.\n\nCool for: Ideologues, Conversationalists, Would-Be-Politicians"
-  },
-  "Drama": {
-    "name": "Drama",
-    "description": "Drama\n\n\n\n\n\n\nDetails\n\nAttribute\nIntellect\n\n\n\nNavigation\n\nPrevious Skill\nRhetoric\n\n\nNext Skill\nConceptualization\n\n\n\nDrama is a skill under the Intellect attribute in Disco Elysium.\n\nPlay the actor. Lie and detect lies.\n\nCool for: Undercover Cops, Thespians of the Stage, Psychopaths"
-  },
-  "Conceptualization": {
-    "name": "Conceptualization",
-    "description": "Conceptualization\n\n\n\n\n\n\nDetails\n\nAttribute\nIntellect\n\n\n\nNavigation\n\nPrevious Skill\nDrama\n\n\nNext Skill\nVisual Calculus\n\n\n\nConceptualization is a skill under the Intellect attribute in Disco Elysium.\n\nUnderstand creativity. See Art in the world.\n\nCool for: Creatives, Psychedelic Fanciers, Critics."
-  },
-  "Visual_Calculus": {
-    "name": "Visual Calculus",
-    "description": "Visual Calculus\n\n\n\n\n\n\nDetails\n\nAttribute\nIntellect\n\n\n\nNavigation\n\nPrevious Skill\nConceptualization\n\n\n\nVisual Calculus is a skill under the Intellect attribute in Disco Elysium.\n\nReconstruct crime scenes. Make laws of physics work for the Law.\n\nCool for: Forensics Scientists, Tactical Fighters, Math-Minded People"
-  },
-  "Volition": {
-    "name": "Volition",
-    "description": "Volition\n\n\n\n\n\n\nDetails\n\nAttribute\nPsyche\n\n\n\nNavigation\n\nNext Skill\nInland Empire\n\n\n\nVolition is a skill under the Psyche attribute in Disco Elysium.\n\nHold yourself together. Keep your Morale up.\n\nCool for: Sane People, Well-Adjusted Cops, The Non-Suicidal"
-  },
-  "Inland_Empire": {
-    "name": "Inland Empire",
-    "description": "Inland Empire\n\n\n\n\n\n\nDetails\n\nAttribute\nPsyche\n\n\n\nNavigation\n\nPrevious Skill\nVolition\n\n\nNext Skill\nEmpathy\n\n\n\nInland Empire is a skill under the Psyche attribute in Disco Elysium.\n\nHunches and gut feelings. Dreams in waking life.\n\nCool for: Dreamers, Para-Natural Investigators, Mental Creators"
-  },
-  "Empathy": {
-    "name": "Empathy",
-    "description": "Empathy\n\n\n\n\n\n\nDetails\n\nAttribute\nPsyche\n\n\n\nNavigation\n\nPrevious Skill\nInland Empire\n\n\nNext Skill\nAuthority\n\n\n\nEmpathy is a skill under the Psyche attribute in Disco Elysium.\n\nUnderstand others. Work your mirror neurons.\n\nCool for: Judges of Character, Interviewers, Interrogators"
-  },
-  "Authority": {
-    "name": "Authority",
-    "description": "Authority\n\n\n\n\n\n\nDetails\n\nAttribute\nPsyche\n\n\n\nNavigation\n\nPrevious Skill\nEmpathy\n\n\nNext Skill\nEsprit de Corps\n\n\n\nAuthority is a skill under the Psyche attribute in Disco Elysium.\n\nIntimidate the public. Assert yourself.\n\nCool for: Leaders, Experts of Psychological Warfare, Respect-Junkies"
-  },
-  "Esprit_de_Corps": {
-    "name": "Esprit de Corps",
-    "description": "Esprit de Corps\n\n\n\n\n\n\nDetails\n\nAttribute\nPsyche\n\n\n\nNavigation\n\nPrevious Skill\nAuthority\n\n\nNext Skill\nSuggestion\n\n\n\nEsprit de Corps is a skill under the Psyche attribute in Disco Elysium.\n\nConnect to Station 41. Understand cop culture.\n\nCool for: Cops, Cop-Aficionados, Pretend-Cops"
-  },
-  "Suggestion": {
-    "name": "Suggestion",
-    "description": "Suggestion\n\n\n\n\n\n\nDetails\n\nAttribute\nPsyche\n\n\n\nNavigation\n\nPrevious Skill\nEsprit de Corps\n\n\n\nSuggestion is a skill under the Psyche attribute in Disco Elysium.\n\nCharm men and women. Play the puppet-master.\n\nCool for: Diplomats, Charmers, Sociopaths"
-  },
-  "Endurance": {
-    "name": "Endurance",
-    "description": "Endurance\n\n\n\n\n\n\nDetails\n\nAttribute\nPhysique\n\n\n\nNavigation\n\nNext Skill\nPain Threshold\n\n\n\nEndurance is a skill under the Physique attribute in Disco Elysium.\n\nTake the blows. Don‚Äôt let the world kill you.\n\nCool for: Fighters who can take a hit, Lookouts who don‚Äôt sleep, Human Batteries"
-  },
-  "Pain_Threshold": {
-    "name": "Pain Threshold",
-    "description": "Pain Threshold\n\n\n\n\n\n\nDetails\n\nAttribute\nPhysique\n\n\n\nNavigation\n\nPrevious Skill\nEndurance\n\n\nNext Skill\nPhysical Instrument\n\n\n\nPain Threshold is a skill under the Physique attribute in Disco Elysium.\n\nShrug off the pain. They‚Äôll have to hurt you more.\n\nCool for: Unstoppable Fighters, Guys who don‚Äôt die, Masochists"
-  },
-  "Physical_Instrument": {
-    "name": "Physical Instrument",
-    "description": "Physical Instrument\n\n\n\n\n\n\nDetails\n\nAttribute\nPhysique\n\n\n\nNavigation\n\nPrevious Skill\nPain Threshold\n\n\nNext Skill\nElectrochemistry\n\n\n\nPhysical Instrument is a skill under the Physique attribute in Disco Elysium.\n\nFlex powerful muscles. Enjoy healthy organs.\n\nCool for: Muscle Men, Bare Knuckle Brawlers, Gym Teachers"
-  },
-  "Electrochemistry": {
-    "name": "Electrochemistry",
-    "description": "Electrochemistry\n\n\n\n\n\n\nDetails\n\nAttribute\nPhysique\n\n\n\nNavigation\n\nPrevious Skill\nPhysical Instrument\n\n\nNext Skill\nShivers\n\n\n\nElectrochemistry is a skill under the Physique attribute in Disco Elysium.\n\nGo to party planet. Love and be loved by drugs.\n\nCool for: High-Fliers, Party Enthusiasts, Cops who need Lightning"
-  },
-  "Shivers": {
-    "name": "Shivers",
-    "description": "Shivers\n\n\n\n\n\n\nDetails\n\nAttribute\nPhysique\n\n\n\nNavigation\n\nPrevious Skill\nElectrochemistry\n\n\nNext Skill\nHalf Light\n\n\n\nShivers is a skill under the Physique attribute in Disco Elysium.\n\nRaise the hair on your neck. Tune in to the city.\n\nCool for: City Lovers, The Wisest of the Street Wise, The Genuinely Supra-Natural"
-  },
-  "Half_Light": {
-    "name": "Half Light",
-    "description": "Half Light\n\n\n\n\n\n\nDetails\n\nAttribute\nPhysique\n\n\n\nNavigation\n\nPrevious Skill\nShivers\n\n\n\nHalf Light is a skill under the Physique attribute in Disco Elysium.\n\nLet the body take control. Threaten people.\n\nCool for: High-Strung Investigators, Shoot-Now-Ask-Questions-Later Cops, Surprise Haters"
-  },
-  "Hand-Eye_Coordination": {
-    "name": "Hand-Eye Coordination",
-    "description": "Hand-Eye Coordination\n\n\n\n\n\n\nDetails\n\nAttribute\nMotorics\n\n\n\nNavigation\n\nNext Skill\nPerception\n\n\n\nHand/Eye Coordination is a skill under the Motorics attribute in Disco Elysium.\n\nReady? Aim and fire.\n\nCool for: Trick-Shooters, Snipers, Jugglers"
-  },
-  "Perception": {
-    "name": "Perception",
-    "description": "Perception\n\n\n\n\n\n\nDetails\n\nAttribute\nMotorics\n\n\n\nNavigation\n\nPrevious Skill\nHand/Eye Coordination\n\n\nNext Skill\nReaction Speed\n\n\n\nPerception is a skill under the Motorics attribute in Disco Elysium.\n\nSee, hear and smell everything. Let no detail go unnoticed.\n\nCool for: Fine Detail Detectives, Sensualists, Urban Scavengers"
-  },
-  "Reaction_Speed": {
-    "name": "Reaction Speed",
-    "description": "Reaction Speed\n\n\n\n\n\n\nDetails\n\nAttribute\nMotorics\n\n\n\nNavigation\n\nPrevious Skill\nPerception\n\n\nNext Skill\nSavoir Faire\n\n\n\nReaction Speed is a skill under the Motorics attribute in Disco Elysium.\n\nThe quickest to react. An untouchable man.\n\nCool for: Shot-Dodgers, Thinkers on their Feet, Pinball-Heads"
-  },
-  "Savoir_Faire": {
-    "name": "Savoir Faire",
-    "description": "Savoir Faire\n\n\n\n\n\n\nDetails\n\nAttribute\nMotorics\n\n\n\nNavigation\n\nPrevious Skill\nReaction Speed\n\n\nNext Skill\nInterfacing\n\n\n\nSavoir Faire is a skill under the Motorics attribute in Disco Elysium.\n\nSneak under their noses. Stun with immense panache.\n\nCool for: Acrobats, Thieves, Unbearable Show-Offs"
-  },
-  "Interfacing": {
-    "name": "Interfacing",
-    "description": "Interfacing\n\n\n\n\n\n\nDetails\n\nAttribute\nMotorics\n\n\n\nNavigation\n\nPrevious Skill\nSavoir Faire\n\n\nNext Skill\nComposure\n\n\n\nInterfacing is a skill under the Motorics attribute in Disco Elysium.\n\nMaster machines. Pick locks and pockets.\n\nCool for: Machinists, Tinkerers, Instrument Players"
-  },
-  "Composure": {
-    "name": "Composure",
-    "description": "Composure\n\n\n\n\n\n\nDetails\n\nAttribute\nMotorics\n\n\n\nNavigation\n\nPrevious Skill\nInterfacing\n\n\n\nComposure is a skill under the Motorics attribute in Disco Elysium.\n\nStraighten your back. Keep your poker face.\n\nCool for: Card Players, Military Fetishists, Cool People"
-  }
-}
\ No newline at end of file
diff --git a/backend/archive/vibe-coding-scraper-example/scraper.py b/backend/archive/vibe-coding-scraper-example/scraper.py
deleted file mode 100644
index e7bfbf3..0000000
--- a/backend/archive/vibe-coding-scraper-example/scraper.py
+++ /dev/null
@@ -1,43 +0,0 @@
-#!/usr/bin/env python3
-"""Scrape Disco Elysium skill pages."""
-
-import requests
-from bs4 import BeautifulSoup
-from pathlib import Path
-import json
-import time
-
-SKILLS = [
-    "Logic", "Encyclopedia", "Rhetoric", "Drama", "Conceptualization", "Visual_Calculus",
-    "Volition", "Inland_Empire", "Empathy", "Authority", "Esprit_de_Corps", "Suggestion",
-    "Endurance", "Pain_Threshold", "Physical_Instrument", "Electrochemistry", "Shivers", "Half_Light",
-    "Hand-Eye_Coordination", "Perception", "Reaction_Speed", "Savoir_Faire", "Interfacing", "Composure"
-]
-
-OUTPUT_DIR = Path(__file__).parent / "references"
-
-def scrape_skill(skill_name: str) -> dict:
-    url = f"https://discoelysium.fandom.com/wiki/{skill_name}"
-    response = requests.get(url, timeout=10)
-    soup = BeautifulSoup(response.text, 'html.parser')
-
-    content = soup.find('div', {'class': 'mw-parser-output'})
-    paragraphs = [p.get_text().strip() for p in content.find_all('p') if p.get_text().strip()]
-
-    return {
-        "name": skill_name.replace('_', ' '),
-        "description": '\n\n'.join(paragraphs[:3])
-    }
-
-OUTPUT_DIR.mkdir(exist_ok=True)
-skills_data = {}
-
-for skill in SKILLS:
-    print(f"Scraping {skill}...")
-    skills_data[skill] = scrape_skill(skill)
-    time.sleep(0.5)
-
-with open(OUTPUT_DIR / "disco_skills.json", 'w', encoding='utf-8') as f:
-    json.dump(skills_data, f, indent=2, ensure_ascii=False)
-
-print(f"\n‚úÖ Done")
diff --git a/backend/server_old.py b/backend/server_old.py
deleted file mode 100644
index c14b2ec..0000000
--- a/backend/server_old.py
+++ /dev/null
@@ -1,498 +0,0 @@
-#!/usr/bin/env python3
-"""Stateless voice analysis server - no state tracking, just returns new comments."""
-
-import time
-from polycli.orchestration.session_registry import session_def, get_registry
-from polycli import PolyAgent
-from stateless_analyzer import analyze_stateless
-import config
-from proxy_config import get_image_api_proxies
-
-@session_def(
-    name="Chat with Voice",
-    description="Have a conversation with a specific inner voice persona",
-    params={
-        "voice_name": {"type": "str"},
-        "voice_config": {"type": "dict"},
-        "conversation_history": {"type": "list"},
-        "user_message": {"type": "str"},
-        "original_text": {"type": "str"},
-        "meta_prompt": {"type": "str"},
-        "state_prompt": {"type": "str"}
-    },
-    category="Chat"
-)
-def chat_with_voice(voice_name: str, voice_config: dict, conversation_history: list, user_message: str, original_text: str = "", meta_prompt: str = "", state_prompt: str = ""):
-    """
-    Chat with a specific voice persona.
-
-    Args:
-        voice_name: Name of the voice (e.g., "Logic", "Drama")
-        voice_config: Voice configuration with tagline, icon, color
-        conversation_history: Previous messages in the conversation
-        user_message: The user's new message
-        original_text: The user's original writing text
-        meta_prompt: Additional instructions that apply to all voices
-
-    Returns:
-        Dictionary with assistant's response
-    """
-    print(f"\n{'='*60}")
-    print(f"üí¨ chat_with_voice() called")
-    print(f"   Voice: {voice_name}")
-    print(f"   User message: {user_message}")
-    print(f"   History length: {len(conversation_history)}")
-    print(f"   Meta prompt: {repr(meta_prompt)[:100]}")
-    print(f"   State prompt: {repr(state_prompt)[:100]}")
-    print(f"{'='*60}\n")
-
-    agent = PolyAgent(id=f"voice-chat-{voice_name.lower()}")
-
-    # Ensure voice_config is a dict
-    if not isinstance(voice_config, dict):
-        print(f"‚ö†Ô∏è  voice_config is not a dict: {type(voice_config)}, using default")
-        voice_config = {"tagline": f"{voice_name} voice from Disco Elysium"}
-
-    # Build system prompt for this voice
-    system_prompt = f"""You are {voice_name}, an inner voice archetype from Disco Elysium.
-
-Your character: {voice_config.get('tagline', '')}
-
-Respond in character as {voice_name}. Be concise (1-3 sentences). Stay true to your archetype.
-Use the conversation context but focus on your unique perspective."""
-
-    # Add original writing area text if available
-    if original_text and original_text.strip():
-        system_prompt += f"""
-
-Context: The user is writing this text:
----
-{original_text.strip()}
----
-
-Your initial comment was about this text. Keep this context in mind when responding to the user's questions."""
-
-    # Add meta prompt if available
-    if meta_prompt and meta_prompt.strip():
-        system_prompt += f"""
-
-Additional instructions:
-{meta_prompt.strip()}"""
-
-    # @@@ Add state prompt if available (between meta and voice-specific)
-    if state_prompt and state_prompt.strip():
-        system_prompt += f"""
-
-User's current state:
-{state_prompt.strip()}"""
-
-    # Build full prompt with conversation history
-    prompt = system_prompt + "\n\nConversation history:\n"
-
-    # Add conversation history
-    for msg in conversation_history:
-        role_label = "User" if msg["role"] == "user" else voice_name
-        prompt += f"\n{role_label}: {msg['content']}"
-
-    # Add user's new message
-    prompt += f"\n\nUser: {user_message}\n\n{voice_name}:"
-
-    # Get response from LLM
-    result = agent.run(prompt, model="gpt-4o-dou", cli="no-tools", tracked=True)
-
-    if not result.is_success or not result.content:
-        response = "..."
-    else:
-        response = result.content
-
-    print(f"‚úÖ Got response: {response[:100]}...")
-
-    return {
-        "response": response,
-        "voice_name": voice_name
-    }
-
-@session_def(
-    name="Analyze Voices",
-    description="Get one new voice comment for text",
-    params={
-        "text": {"type": "str"},
-        "session_id": {"type": "str"},
-        "voices": {"type": "dict"},
-        "applied_comments": {"type": "list"},
-        "meta_prompt": {"type": "str"},
-        "state_prompt": {"type": "str"}
-    },
-    category="Analysis"
-)
-def analyze_text(text: str, session_id: str, voices: dict = None, applied_comments: list = None, meta_prompt: str = "", state_prompt: str = "", overlapped_phrases: list = None):
-    """
-    Stateless analysis - returns ONE new comment based on text and applied comments.
-
-    Args:
-        text: Text to analyze (should be complete sentences only)
-        session_id: Session ID (for future use)
-        voices: Voice configuration
-        applied_comments: List of already applied comments (to avoid duplicates)
-        meta_prompt: Additional instructions that apply to all voices
-        state_prompt: User's current emotional state prompt
-        overlapped_phrases: Phrases that were rejected due to overlap (feedback loop)
-
-    Returns:
-        Dictionary with single new voice (or empty list)
-    """
-    print(f"\n{'='*60}")
-    print(f"üéØ Stateless analyze_text() called")
-    print(f"   Text: {text[:100]}...")
-    print(f"   Applied comments: {len(applied_comments or [])}")
-    print(f"   Overlapped phrases: {len(overlapped_phrases or [])}")
-    print(f"   Meta prompt: {repr(meta_prompt)[:100]}")
-    print(f"   State prompt: {repr(state_prompt)[:100]}")
-    print(f"{'='*60}\n")
-
-    agent = PolyAgent(id="voice-analyzer")
-
-    # Get voices from stateless analyzer
-    result = analyze_stateless(agent, text, applied_comments or [], voices, meta_prompt, state_prompt, overlapped_phrases or [])
-
-    print(f"‚úÖ Returning {result['new_voices_added']} new voice(s)")
-
-    return {
-        "voices": result["voices"],
-        "new_voices_added": result["new_voices_added"],
-        "status": "completed"
-    }
-
-@session_def(
-    name="Analyze Echoes",
-    description="Find recurring themes and topics in all user notes",
-    params={
-        "all_notes": {"type": "str"}
-    },
-    category="Analysis"
-)
-def analyze_echoes(all_notes: str):
-    """Analyze recurring themes and topics across all notes."""
-    print(f"\n{'='*60}")
-    print(f"üîÑ analyze_echoes() called")
-    print(f"   Notes length: {len(all_notes)} chars")
-    print(f"{'='*60}\n")
-
-    agent = PolyAgent(id="echoes-analyzer")
-
-    prompt = f"""Analyze these personal notes and identify recurring themes, topics, or concerns that keep appearing.
-
-Notes:
----
-{all_notes}
----
-
-Find 3-5 echoes (recurring themes) that appear across different entries. For each echo:
-- Give it a short title (2-4 words)
-- Explain what pattern you see
-- Quote 2-3 specific examples from the notes
-
-Format as a JSON array:
-[
-  {{"title": "...", "description": "...", "examples": ["quote1", "quote2", "quote3"]}},
-  ...
-]
-
-Return ONLY the JSON array, no other text."""
-
-    result = agent.run(prompt, model="gpt-4o-dou", cli="no-tools", tracked=True)
-
-    if not result.is_success or not result.content:
-        return {"echoes": []}
-
-    try:
-        import json
-        echoes = json.loads(result.content.strip())
-        return {"echoes": echoes}
-    except:
-        return {"echoes": []}
-
-@session_def(
-    name="Analyze Traits",
-    description="Identify personality traits and characteristics from user notes",
-    params={
-        "all_notes": {"type": "str"}
-    },
-    category="Analysis"
-)
-def analyze_traits(all_notes: str):
-    """Analyze personality traits from all notes."""
-    print(f"\n{'='*60}")
-    print(f"üë§ analyze_traits() called")
-    print(f"   Notes length: {len(all_notes)} chars")
-    print(f"{'='*60}\n")
-
-    agent = PolyAgent(id="traits-analyzer")
-
-    prompt = f"""Analyze these personal notes and identify personality traits and characteristics.
-
-Notes:
----
-{all_notes}
----
-
-Identify 4-6 personality traits that are evident from the writing. For each trait:
-- Give it a name (1-2 words)
-- Rate the strength (1-5)
-- Explain why you see this trait with specific examples
-
-Format as a JSON array:
-[
-  {{"trait": "...", "strength": 4, "evidence": "..."}},
-  ...
-]
-
-Return ONLY the JSON array, no other text."""
-
-    result = agent.run(prompt, model="gpt-4o-dou", cli="no-tools", tracked=True)
-
-    if not result.is_success or not result.content:
-        return {"traits": []}
-
-    try:
-        import json
-        traits = json.loads(result.content.strip())
-        return {"traits": traits}
-    except:
-        return {"traits": []}
-
-@session_def(
-    name="Analyze Patterns",
-    description="Identify behavioral patterns and habits from user notes",
-    params={
-        "all_notes": {"type": "str"}
-    },
-    category="Analysis"
-)
-def analyze_patterns(all_notes: str):
-    """Analyze behavioral patterns from all notes."""
-    print(f"\n{'='*60}")
-    print(f"üîç analyze_patterns() called")
-    print(f"   Notes length: {len(all_notes)} chars")
-    print(f"{'='*60}\n")
-
-    agent = PolyAgent(id="patterns-analyzer")
-
-    prompt = f"""Analyze these personal notes and identify behavioral patterns or habits.
-
-Notes:
----
-{all_notes}
----
-
-Identify 3-5 behavioral patterns or habits. For each pattern:
-- Give it a descriptive name
-- Describe the pattern
-- Note the frequency/context when it appears
-
-Format as a JSON array:
-[
-  {{"pattern": "...", "description": "...", "frequency": "..."}},
-  ...
-]
-
-Return ONLY the JSON array, no other text."""
-
-    result = agent.run(prompt, model="gpt-4o-dou", cli="no-tools", tracked=True)
-
-    if not result.is_success or not result.content:
-        return {"patterns": []}
-
-    try:
-        import json
-        patterns = json.loads(result.content.strip())
-        return {"patterns": patterns}
-    except:
-        return {"patterns": []}
-
-@session_def(
-    name="Generate Daily Picture",
-    description="Generate an artistic image based on user's daily notes",
-    params={
-        "all_notes": {"type": "str"}
-    },
-    category="Creative"
-)
-def generate_daily_picture(all_notes: str):
-    """Generate an image based on the essence of user's daily notes.
-
-    Uses a two-step process:
-    1. LLM analyzes notes and creates artistic image description
-    2. Image generation model creates the image
-    """
-    print(f"\n{'='*60}")
-    print(f"üé® generate_daily_picture() called")
-    print(f"   Notes length: {len(all_notes)} chars")
-    print(f"{'='*60}\n")
-
-    import requests
-
-    # @@@ Step 1: Convert notes to artistic image description using Claude Haiku
-
-    description_prompt = f"""Read these personal notes and create a vivid, artistic image description that captures the essence, mood, and themes.
-
-Notes:
----
-{all_notes}
----
-
-Create a detailed image description (2-3 sentences) that:
-- Captures the emotional tone and atmosphere
-- Uses visual metaphors for abstract concepts
-- Specifies artistic style (e.g., watercolor, impressionist, minimalist)
-- Describes colors, lighting, composition
-
-Be creative and interpretive. Focus on mood and feeling, not literal representation.
-
-Return ONLY the image description, no other text."""
-
-    print("üß† Creating image description from notes with Claude Haiku...")
-
-    # @@@ Use proxy for GFW bypass (if configured)
-    proxies = get_image_api_proxies()
-
-    claude_response = requests.post(
-        f"{config.IMAGE_API_ENDPOINT}/chat/completions",
-        headers={
-            "Authorization": f"Bearer {config.IMAGE_API_KEY}",
-            "Content-Type": "application/json"
-        },
-        json={
-            "model": config.IMAGE_DESCRIPTION_MODEL,
-            "messages": [{"role": "user", "content": description_prompt}],
-            "max_tokens": config.IMAGE_DESCRIPTION_MAX_TOKENS
-        },
-        proxies=proxies,
-        timeout=config.IMAGE_DESCRIPTION_TIMEOUT
-    )
-
-    if claude_response.status_code != 200:
-        return {"image_base64": None, "error": "Failed to create image description"}
-
-    claude_data = claude_response.json()
-    image_description = claude_data.get('choices', [{}])[0].get('message', {}).get('content', '').strip()
-
-    if not image_description:
-        return {"image_base64": None, "error": "Failed to create image description"}
-
-    print(f"üìù Image description: {image_description}")
-
-    # @@@ Step 2: Generate image from description with retry logic
-    url = f"{config.IMAGE_API_ENDPOINT}/chat/completions"
-    headers = {
-        "Authorization": f"Bearer {config.IMAGE_API_KEY}",
-        "Content-Type": "application/json"
-    }
-
-    payload = {
-        "model": config.IMAGE_GENERATION_MODEL,
-        "messages": [
-            {
-                "role": "user",
-                "content": image_description
-            }
-        ],
-        "max_tokens": config.IMAGE_MAX_TOKENS
-    }
-
-    # @@@ Retry logic with increasing timeouts
-    for attempt in range(1, config.IMAGE_RETRY_MAX_ATTEMPTS + 1):
-        try:
-            timeout_seconds = config.IMAGE_RETRY_BASE_TIMEOUT + (attempt - 1) * config.IMAGE_RETRY_TIMEOUT_INCREMENT
-            print(f"üé® Generating image (attempt {attempt}/{config.IMAGE_RETRY_MAX_ATTEMPTS}, timeout={timeout_seconds}s)...")
-            response = requests.post(url, headers=headers, json=payload, proxies=proxies, timeout=timeout_seconds)
-
-            if response.status_code != 200:
-                print(f"‚ùå Error: {response.status_code}")
-                if attempt < config.IMAGE_RETRY_MAX_ATTEMPTS:
-                    print(f"‚è≥ Retrying in 2 seconds...")
-                    import time
-                    time.sleep(2)
-                    continue
-                return {"image_base64": None, "error": "Image generation failed"}
-
-            data = response.json()
-
-            # Extract image from response
-            if 'choices' in data and len(data['choices']) > 0:
-                message = data['choices'][0].get('message', {})
-                images = message.get('images', [])
-
-                if images:
-                    image_data = images[0].get('image_url', {}).get('url', '')
-
-                    if image_data.startswith('data:image/png;base64,'):
-                        # Extract base64 data (without the data URI prefix)
-                        base64_data = image_data.split(',', 1)[1]
-
-                        print(f"‚úÖ Image generated successfully")
-                        print(f"   Size: {len(base64_data)} chars")
-
-                        return {
-                            "image_base64": base64_data,
-                            "prompt": image_description  # Return the creative description
-                        }
-
-            if attempt < config.IMAGE_RETRY_MAX_ATTEMPTS:
-                print(f"‚ö†Ô∏è No image in response, retrying...")
-                import time
-                time.sleep(2)
-                continue
-            return {"image_base64": None, "error": "No image in response"}
-
-        except Exception as e:
-            print(f"‚ùå Exception on attempt {attempt}: {e}")
-            if attempt < config.IMAGE_RETRY_MAX_ATTEMPTS:
-                print(f"‚è≥ Retrying in 2 seconds...")
-                import time
-                time.sleep(2)
-                continue
-            return {"image_base64": None, "error": str(e)}
-
-    return {"image_base64": None, "error": "All retry attempts failed"}
-
-if __name__ == "__main__":
-    # Get the global registry
-    registry = get_registry()
-
-    # Start the control panel
-    print("\n" + "="*60)
-    print("üé≠ Stateless Voice Analysis Server")
-    print("="*60)
-
-    # Monkey-patch to add /api/default-voices endpoint
-    server, thread = registry.serve_control_panel(port=8765)
-
-    original_do_get = server.RequestHandlerClass.do_GET
-    def patched_do_get(handler_self):
-        if handler_self.path == "/api/default-voices":
-            import json
-            body = json.dumps(config.VOICE_ARCHETYPES).encode("utf-8")
-            handler_self.send_response(200)
-            handler_self.send_header("Content-Type", "application/json")
-            handler_self.send_header("Access-Control-Allow-Origin", "*")
-            handler_self.end_headers()
-            handler_self.wfile.write(body)
-        else:
-            original_do_get(handler_self)
-
-    server.RequestHandlerClass.do_GET = patched_do_get
-
-    print("\nüìö Available endpoints:")
-    print("  - POST /api/trigger")
-    print("    Body: {\"session_id\": \"analyze_text\", \"params\": {\"text\": \"...\", \"applied_comments\": [...]}}")
-    print("    Body: {\"session_id\": \"chat_with_voice\", \"params\": {\"voice_name\": \"...\", \"user_message\": \"...\", ...}}")
-    print("  - GET /api/default-voices")
-    print("\n" + "="*60 + "\n")
-
-    # Keep server running
-    try:
-        while True:
-            time.sleep(1)
-    except KeyboardInterrupt:
-        print("\n\nüëã Shutting down...")
\ No newline at end of file
diff --git a/backend/test_migration.py b/backend/test_migration.py
deleted file mode 100644
index 0063d0e..0000000
--- a/backend/test_migration.py
+++ /dev/null
@@ -1,205 +0,0 @@
-#!/usr/bin/env python3
-"""
-Test migration of real localStorage data to database.
-
-This script:
-1. Loads the real_user_data.json export
-2. Parses all localStorage data
-3. Creates a test user
-4. Migrates all data to database
-5. Verifies migration success
-"""
-
-import json
-import sys
-from datetime import datetime
-import bcrypt
-from database import (
-    init_db, create_user, import_user_data,
-    get_user_by_id, list_sessions, get_daily_pictures,
-    get_preferences, get_analysis_reports
-)
-
-def parse_localStorage_export(filepath):
-    """Parse the localStorage export JSON."""
-    print(f"üìÇ Loading {filepath}...")
-
-    with open(filepath, 'r') as f:
-        data = json.load(f)
-
-    print(f"‚úÖ Loaded {data.get('sizeEstimate', 'unknown')} of data")
-
-    return data
-
-def extract_sessions(data):
-    """Extract all sessions from current session + calendar entries."""
-    sessions = []
-
-    # 1. Current session
-    if data.get('currentSession'):
-        current = json.loads(data['currentSession'])
-        sessions.append({
-            'id': 'current-session',
-            'name': 'Current Session',
-            'editor_state': current
-        })
-        print(f"  ‚úÖ Current session: {len(current.get('cells', []))} cells")
-
-    # 2. Calendar entries (each entry is a separate session)
-    if data.get('calendarEntries'):
-        calendar = json.loads(data['calendarEntries'])
-
-        for date, entries in calendar.items():
-            for entry in entries:
-                sessions.append({
-                    'id': entry['id'],
-                    'name': f"{date} - {entry.get('firstLine', 'Untitled')}",
-                    'editor_state': entry['state']
-                })
-
-        total_entries = sum(len(entries) for entries in calendar.values())
-        print(f"  ‚úÖ Calendar: {len(calendar)} days, {total_entries} entries")
-
-    # 3. Old document system (if used)
-    if data.get('oldDocument'):
-        try:
-            old_doc = json.loads(data['oldDocument'])
-            if old_doc and old_doc.get('document'):
-                sessions.append({
-                    'id': 'old-document',
-                    'name': 'Old Document (migrated)',
-                    'editor_state': {'cells': [{'type': 'text', 'content': str(old_doc)}]}
-                })
-                print(f"  ‚ö†Ô∏è Old document system found (migrated as text)")
-        except:
-            pass
-
-    return sessions
-
-def extract_pictures(data):
-    """Extract daily pictures."""
-    pictures = []
-
-    if data.get('dailyPictures'):
-        pics = json.loads(data['dailyPictures'])
-        for pic in pics:
-            pictures.append({
-                'date': pic['date'],
-                'image_base64': pic['base64'],
-                'prompt': pic.get('prompt', '')
-            })
-
-        print(f"  ‚úÖ Pictures: {len(pictures)} images")
-
-    return pictures
-
-def extract_preferences(data):
-    """Extract user preferences."""
-    prefs = {}
-
-    if data.get('voiceCustomizations'):
-        prefs['voice_configs'] = json.loads(data['voiceCustomizations'])
-
-    if data.get('metaPrompt'):
-        prefs['meta_prompt'] = data['metaPrompt']
-
-    if data.get('stateConfig'):
-        prefs['state_config'] = json.loads(data['stateConfig'])
-
-    if data.get('selectedState'):
-        prefs['selected_state'] = data['selectedState']
-
-    print(f"  ‚úÖ Preferences: {len(prefs)} items")
-
-    return prefs
-
-def extract_reports(data):
-    """Extract analysis reports."""
-    reports = []
-
-    if data.get('analysisReports'):
-        report_list = json.loads(data['analysisReports'])
-        for report in report_list:
-            reports.append({
-                'type': report.get('type', 'unknown'),
-                'data': report.get('data', {}),
-                'allNotes': report.get('allNotes', ''),
-                'timestamp': report.get('timestamp', datetime.now().isoformat())
-            })
-
-        print(f"  ‚úÖ Reports: {len(reports)} analysis reports")
-
-    return reports
-
-def test_migration():
-    """Run the full migration test."""
-    print("\n" + "="*60)
-    print("üß™ Testing localStorage Migration")
-    print("="*60 + "\n")
-
-    # Step 1: Initialize database
-    print("1Ô∏è‚É£ Initializing database...")
-    init_db()
-
-    # Step 2: Load localStorage export
-    print("\n2Ô∏è‚É£ Loading localStorage export...")
-    data = parse_localStorage_export('test_data/real_user_data.json')
-
-    # Step 3: Extract all data
-    print("\n3Ô∏è‚É£ Extracting data...")
-    sessions = extract_sessions(data)
-    pictures = extract_pictures(data)
-    preferences = extract_preferences(data)
-    reports = extract_reports(data)
-
-    # Step 4: Create test user
-    print("\n4Ô∏è‚É£ Creating test user...")
-    password_hash = bcrypt.hashpw(b"test123", bcrypt.gensalt()).decode('utf-8')
-    user_id = create_user('test@example.com', password_hash, 'Test User')
-    print(f"  ‚úÖ User created: ID={user_id}")
-
-    # Step 5: Import all data
-    print("\n5Ô∏è‚É£ Importing data to database...")
-    import_user_data(user_id, sessions, pictures, preferences, reports)
-
-    # Step 6: Verify migration
-    print("\n6Ô∏è‚É£ Verifying migration...")
-
-    user = get_user_by_id(user_id)
-    print(f"  ‚úÖ User: {user['email']}")
-
-    db_sessions = list_sessions(user_id)
-    print(f"  ‚úÖ Sessions: {len(db_sessions)} (expected {len(sessions)})")
-
-    db_pictures = get_daily_pictures(user_id, limit=100)
-    print(f"  ‚úÖ Pictures: {len(db_pictures)} (expected {len(pictures)})")
-
-    db_prefs = get_preferences(user_id)
-    if db_prefs:
-        print(f"  ‚úÖ Preferences: {len([k for k, v in db_prefs.items() if v is not None])} items")
-
-    db_reports = get_analysis_reports(user_id, limit=100)
-    print(f"  ‚úÖ Reports: {len(db_reports)} (expected {len(reports)})")
-
-    # Success!
-    print("\n" + "="*60)
-    print("‚úÖ Migration test PASSED!")
-    print("="*60)
-    print(f"\nMigrated:")
-    print(f"  - {len(sessions)} sessions")
-    print(f"  - {len(pictures)} images (freed ~{len(pictures) * 2.5:.1f}MB from localStorage!)")
-    print(f"  - {len([k for k, v in preferences.items() if v])} preference items")
-    print(f"  - {len(reports)} analysis reports")
-
-    return True
-
-if __name__ == "__main__":
-    try:
-        test_migration()
-        sys.exit(0)
-    except Exception as e:
-        print(f"\n‚ùå Migration test FAILED!")
-        print(f"Error: {e}")
-        import traceback
-        traceback.print_exc()
-        sys.exit(1)
diff --git a/backend/test_real_migration.py b/backend/test_real_migration.py
deleted file mode 100644
index fa3d1ab..0000000
--- a/backend/test_real_migration.py
+++ /dev/null
@@ -1,210 +0,0 @@
-#!/usr/bin/env python3
-"""
-Test full migration flow with real user data.
-
-Simulates:
-1. User registers
-2. User logs in
-3. Frontend sends localStorage data
-4. Backend imports to database
-5. Frontend fetches data back
-"""
-
-import requests
-import json
-
-API_BASE = "http://localhost:8765"
-
-def test_full_migration():
-    print("\n" + "="*60)
-    print("üß™ Testing Full Migration with Real Data")
-    print("="*60 + "\n")
-
-    # Load real localStorage export
-    print("üìÇ Loading real localStorage export...")
-    with open('test_data/real_user_data.json', 'r') as f:
-        real_data = json.load(f)
-
-    print(f"‚úÖ Loaded {real_data.get('sizeEstimate', 'unknown')}")
-    print()
-
-    # Step 1: Register
-    print("1Ô∏è‚É£ Registering new user...")
-    register_response = requests.post(
-        f"{API_BASE}/api/register",
-        json={
-            "email": "realuser@example.com",
-            "password": "password123",
-            "display_name": "Real User"
-        }
-    )
-
-    if register_response.status_code != 200:
-        print(f"‚ùå Registration failed: {register_response.text}")
-        return False
-
-    register_data = register_response.json()
-    token = register_data['token']
-    user_id = register_data['user']['id']
-    print(f"‚úÖ User registered: ID={user_id}")
-    print()
-
-    # Step 2: Import localStorage data
-    print("2Ô∏è‚É£ Importing localStorage data...")
-
-    # Prepare import request (match frontend localStorage keys)
-    import_request = {
-        "currentSession": real_data.get('currentSession'),
-        "calendarEntries": real_data.get('calendarEntries'),
-        "dailyPictures": real_data.get('dailyPictures'),
-        "voiceCustomizations": real_data.get('voiceCustomizations'),
-        "metaPrompt": real_data.get('metaPrompt'),
-        "stateConfig": real_data.get('stateConfig'),
-        "selectedState": real_data.get('selectedState'),
-        "analysisReports": real_data.get('analysisReports'),
-        "oldDocument": real_data.get('oldDocument')
-    }
-
-    import_response = requests.post(
-        f"{API_BASE}/api/import-local-data",
-        headers={"Authorization": f"Bearer {token}"},
-        json=import_request
-    )
-
-    if import_response.status_code != 200:
-        print(f"‚ùå Import failed: {import_response.text}")
-        return False
-
-    import_result = import_response.json()
-    print(f"‚úÖ Import successful!")
-    print(f"   Sessions: {import_result['imported']['sessions']}")
-    print(f"   Pictures: {import_result['imported']['pictures']}")
-    print(f"   Preferences: {import_result['imported']['preferences']}")
-    print(f"   Reports: {import_result['imported']['reports']}")
-    print()
-
-    # Step 3: Verify - List sessions
-    print("3Ô∏è‚É£ Verifying data - List sessions...")
-    sessions_response = requests.get(
-        f"{API_BASE}/api/sessions",
-        headers={"Authorization": f"Bearer {token}"}
-    )
-
-    if sessions_response.status_code != 200:
-        print(f"‚ùå Failed to list sessions: {sessions_response.text}")
-        return False
-
-    sessions = sessions_response.json()['sessions']
-    print(f"‚úÖ Found {len(sessions)} sessions:")
-    for session in sessions[:3]:  # Show first 3
-        print(f"   - {session['name']} (updated: {session['updated_at']})")
-    if len(sessions) > 3:
-        print(f"   ... and {len(sessions) - 3} more")
-    print()
-
-    # Step 4: Verify - Get a session's full state
-    if sessions:
-        print("4Ô∏è‚É£ Fetching full session state...")
-        session_id = sessions[0]['id']
-        session_response = requests.get(
-            f"{API_BASE}/api/sessions/{session_id}",
-            headers={"Authorization": f"Bearer {token}"}
-        )
-
-        if session_response.status_code != 200:
-            print(f"‚ùå Failed to get session: {session_response.text}")
-            return False
-
-        session_data = session_response.json()
-        editor_state = session_data['editor_state']
-        num_cells = len(editor_state.get('cells', []))
-        print(f"‚úÖ Session '{session_data['name']}' has {num_cells} cells")
-        print()
-
-    # Step 5: Verify - Get pictures
-    print("5Ô∏è‚É£ Verifying pictures...")
-    pictures_response = requests.get(
-        f"{API_BASE}/api/pictures?limit=10",
-        headers={"Authorization": f"Bearer {token}"}
-    )
-
-    if pictures_response.status_code != 200:
-        print(f"‚ùå Failed to get pictures: {pictures_response.text}")
-        return False
-
-    pictures = pictures_response.json()['pictures']
-    print(f"‚úÖ Found {len(pictures)} pictures:")
-    for pic in pictures:
-        size_kb = len(pic['image_base64']) / 1024
-        print(f"   - {pic['date']}: {size_kb:.1f} KB ({pic.get('prompt', 'no prompt')[:50]}...)")
-
-    total_size_mb = sum(len(p['image_base64']) for p in pictures) / 1024 / 1024
-    print(f"   Total: {total_size_mb:.2f} MB (was in localStorage!)")
-    print()
-
-    # Step 6: Verify - Get preferences
-    print("6Ô∏è‚É£ Verifying preferences...")
-    prefs_response = requests.get(
-        f"{API_BASE}/api/preferences",
-        headers={"Authorization": f"Bearer {token}"}
-    )
-
-    if prefs_response.status_code != 200:
-        print(f"‚ùå Failed to get preferences: {prefs_response.text}")
-        return False
-
-    prefs = prefs_response.json()
-    print(f"‚úÖ Preferences loaded:")
-    if prefs.get('meta_prompt'):
-        print(f"   - Meta prompt: {prefs['meta_prompt'][:50]}...")
-    if prefs.get('selected_state'):
-        print(f"   - Selected state: {prefs['selected_state']}")
-    if prefs.get('voice_configs'):
-        num_voices = len(prefs['voice_configs'])
-        print(f"   - Voice configs: {num_voices} voices")
-    print()
-
-    # Step 7: Verify - Get reports
-    print("7Ô∏è‚É£ Verifying analysis reports...")
-    reports_response = requests.get(
-        f"{API_BASE}/api/reports?limit=10",
-        headers={"Authorization": f"Bearer {token}"}
-    )
-
-    if reports_response.status_code != 200:
-        print(f"‚ùå Failed to get reports: {reports_response.text}")
-        return False
-
-    reports = reports_response.json()['reports']
-    print(f"‚úÖ Found {reports} reports:")
-    for report in reports:
-        print(f"   - {report['report_type']} (created: {report['created_at']})")
-    print()
-
-    # Success summary
-    print("="*60)
-    print("‚úÖ MIGRATION TEST PASSED!")
-    print("="*60)
-    print(f"\nMigrated from localStorage ‚Üí SQLite:")
-    print(f"  - {import_result['imported']['sessions']} sessions")
-    print(f"  - {import_result['imported']['pictures']} pictures ({total_size_mb:.2f} MB freed!)")
-    print(f"  - {import_result['imported']['preferences']} preference items")
-    print(f"  - {import_result['imported']['reports']} analysis reports")
-    print(f"\nAll data successfully retrieved via API!")
-    print("="*60 + "\n")
-
-    return True
-
-if __name__ == "__main__":
-    try:
-        success = test_full_migration()
-        if success:
-            print("üéâ Ready to build frontend!")
-        else:
-            print("‚ùå Migration test failed")
-            exit(1)
-    except Exception as e:
-        print(f"\n‚ùå Error: {e}")
-        import traceback
-        traceback.print_exc()
-        exit(1)
diff --git a/frontend/src/components/BinderRing.tsx b/frontend/src/components/BinderRing.tsx
deleted file mode 100644
index 3f31183..0000000
--- a/frontend/src/components/BinderRing.tsx
+++ /dev/null
@@ -1,16 +0,0 @@
-interface BinderRingProps {
-  position: number;  // 0-100% vertical position
-}
-
-export default function BinderRing({ position }: BinderRingProps) {
-  return (
-    <div
-      className="binder-ring"
-      style={{ top: `${position}%` }}
-    >
-      <div className="hole-left" />
-      <div className="ring-bar" />
-      <div className="hole-right" />
-    </div>
-  );
-}
\ No newline at end of file
diff --git a/frontend/src/components/BinderRings.tsx b/frontend/src/components/BinderRings.tsx
deleted file mode 100644
index 8855a98..0000000
--- a/frontend/src/components/BinderRings.tsx
+++ /dev/null
@@ -1,13 +0,0 @@
-import BinderRing from './BinderRing';
-
-export default function BinderRings() {
-  return (
-    <>
-      <BinderRing position={20} />
-      <BinderRing position={35} />
-      <BinderRing position={50} />
-      <BinderRing position={65} />
-      <BinderRing position={80} />
-    </>
-  );
-}
\ No newline at end of file
diff --git a/frontend/src/components/BookPage.tsx b/frontend/src/components/BookPage.tsx
deleted file mode 100644
index 71f42ce..0000000
--- a/frontend/src/components/BookPage.tsx
+++ /dev/null
@@ -1,18 +0,0 @@
-import { type ReactNode, forwardRef } from 'react';
-
-interface BookPageProps {
-  children?: ReactNode;
-  side: 'left' | 'right';
-}
-
-const BookPage = forwardRef<HTMLDivElement, BookPageProps>(({ children, side }, ref) => {
-  return (
-    <div className={`book-page ${side}-page`} ref={ref}>
-      {children}
-    </div>
-  );
-});
-
-BookPage.displayName = 'BookPage';
-
-export default BookPage;
\ No newline at end of file
diff --git a/frontend/src/components/CalendarView.tsx b/frontend/src/components/CalendarView.tsx
deleted file mode 100644
index 536eb0d..0000000
--- a/frontend/src/components/CalendarView.tsx
+++ /dev/null
@@ -1,266 +0,0 @@
-import { useState } from 'react';
-
-export default function CalendarView() {
-  const [hoveredDay, setHoveredDay] = useState<number | null>(null);
-
-  // Fake calendar data
-  const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
-  const currentMonth = new Date().getMonth();
-  const currentYear = new Date().getFullYear();
-  const currentDate = new Date().getDate();
-
-  // Generate days for current month
-  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
-  const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
-
-  // Fake writing entries with summaries
-  const fakeEntries: Record<number, { count: number; summary: string }> = {
-    3: { count: 2, summary: '‰ªäÂ§©ÂÜô‰∫ÜÂÖ≥‰∫éËÆ∞ÂøÜ‰∏éÊó∂Èó¥ÁöÑÊÄùËÄÉ„ÄÇÊ∫ê‰ª£Á†Å‰ºöË¥¨ÂÄºÔºå‰ΩÜÊòØÊÄùÊÉ≥‰∏ç‰ºö„ÄÇ' },
-    5: { count: 1, summary: 'ËÆ∞ÂΩï‰∫Ü‰∏Ä‰∏™ÊúâË∂£ÁöÑÊÉ≥Ê≥ïÔºöÂ¶Ç‰ΩïÁî®‰ª£Á†ÅË°®ËææÊÉÖÊÑüÔºü' },
-    8: { count: 3, summary: 'Êé¢Á¥¢‰∫Ü‰∫∫Â∑•Êô∫ËÉΩ‰∏éÂàõÈÄ†ÂäõÁöÑËæπÁïå„ÄÇÂÜô‰ΩúÊòØ‰∏ÄÁßçÂØπËØù„ÄÇ' },
-    12: { count: 1, summary: 'ÂÖ≥‰∫éÈòÖËØªÂíåÂÜô‰ΩúÁöÑÂÖ≥Á≥ª„ÄÇËæìÂÖ•ÂÜ≥ÂÆöËæìÂá∫„ÄÇ' },
-    15: { count: 2, summary: 'ÊÄùËÄÉ‰∫ÜÁü•ËØÜÁÆ°ÁêÜÁöÑÊú¨Ë¥®„ÄÇÁ¨îËÆ∞‰∏çÊòØÁõÆÁöÑÔºåÁêÜËß£ÊâçÊòØ„ÄÇ' },
-    18: { count: 4, summary: 'Ê∑±ÂÖ•ÂàÜÊûê‰∫ÜËÆæËÆ°Ê®°ÂºèÂú®ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÁöÑÂ∫îÁî®„ÄÇÁêÜËÆ∫‰∏éÂÆûË∑µÁöÑÁªìÂêà„ÄÇ' },
-    21: { count: 1, summary: '‰ªäÂ§©ÁöÑÂøÉÊÉÖÊúâÁÇπ‰ΩéËêΩÔºå‰ΩÜÂÜô‰ΩúÂ∏ÆÂä©ÊàëÁêÜÊ∏Ö‰∫ÜÊÄùÁª™„ÄÇ' }
-  };
-
-  const days = [];
-  // Empty cells for days before month starts
-  for (let i = 0; i < firstDayOfMonth; i++) {
-    days.push(<div key={`empty-${i}`} style={{ padding: 12 }} />);
-  }
-  // Actual days
-  for (let day = 1; day <= daysInMonth; day++) {
-    const isToday = day === currentDate;
-    const entry = fakeEntries[day];
-    const hasEntries = !!entry;
-
-    days.push(
-      <div
-        key={day}
-        style={{
-          padding: 12,
-          textAlign: 'center',
-          borderRadius: 8,
-          background: isToday ? '#fffef9' : hasEntries ? '#f9f5ed' : 'transparent',
-          border: isToday ? '2px solid #333' : hasEntries ? '1px solid #d0c4b0' : '1px solid transparent',
-          cursor: hasEntries ? 'pointer' : 'default',
-          position: 'relative',
-          fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif",
-          fontSize: 16,
-          fontWeight: isToday ? 600 : 400,
-          color: isToday ? '#333' : hasEntries ? '#555' : '#999',
-          transition: 'all 0.2s'
-        }}
-        onMouseEnter={() => {
-          if (hasEntries) {
-            setHoveredDay(day);
-          }
-        }}
-        onMouseLeave={() => {
-          if (hasEntries) {
-            setHoveredDay(null);
-          }
-        }}
-      >
-        {day}
-        {hasEntries && (
-          <div style={{
-            position: 'absolute',
-            bottom: 4,
-            left: '50%',
-            transform: 'translateX(-50%)',
-            display: 'flex',
-            gap: 2
-          }}>
-            {Array.from({ length: Math.min(entry.count, 5) }).map((_, i) => (
-              <div
-                key={i}
-                style={{
-                  width: 4,
-                  height: 4,
-                  borderRadius: '50%',
-                  background: '#8b7355'
-                }}
-              />
-            ))}
-          </div>
-        )}
-      </div>
-    );
-  }
-
-  const currentEntry = hoveredDay ? fakeEntries[hoveredDay] : null;
-
-  return (
-    <div style={{
-      width: '100%',
-      height: '100%',
-      display: 'flex',
-      alignItems: 'center',
-      justifyContent: 'center',
-      padding: '2rem',
-      boxSizing: 'border-box'
-    }}>
-      {/* Center container for both panels */}
-      <div style={{
-        display: 'flex',
-        gap: '2.5rem',
-        alignItems: 'stretch'
-      }}>
-        {/* Left: Calendar Grid */}
-        <div style={{
-          flex: '0 0 auto',
-          width: 600,
-          background: '#fffef9',
-          borderRadius: 8,
-          padding: '2rem',
-          border: '1px solid #d0c4b0',
-          boxShadow: '0 4px 12px rgba(0,0,0,0.1)'
-        }}>
-          {/* Header */}
-          <div style={{
-            textAlign: 'center',
-            marginBottom: '2rem',
-            fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif",
-            fontSize: 24,
-            fontWeight: 600,
-            color: '#333'
-          }}>
-            {months[currentMonth]} {currentYear}
-          </div>
-
-          {/* Day headers */}
-          <div style={{
-            display: 'grid',
-            gridTemplateColumns: 'repeat(7, 1fr)',
-            gap: 4,
-            marginBottom: 8
-          }}>
-            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
-              <div
-                key={day}
-                style={{
-                  padding: 8,
-                  textAlign: 'center',
-                  fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif",
-                  fontSize: 14,
-                  fontWeight: 600,
-                  color: '#8b7355'
-                }}
-              >
-                {day}
-              </div>
-            ))}
-          </div>
-
-          {/* Calendar grid */}
-          <div style={{
-            display: 'grid',
-            gridTemplateColumns: 'repeat(7, 1fr)',
-            gap: 4
-          }}>
-            {days}
-          </div>
-
-          {/* Legend */}
-          <div style={{
-            marginTop: '2rem',
-            paddingTop: '1rem',
-            borderTop: '1px solid #d0c4b0',
-            display: 'flex',
-            gap: '1rem',
-            justifyContent: 'center',
-            fontSize: 14,
-            color: '#666',
-            fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif"
-          }}>
-            <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
-              <div style={{ width: 4, height: 4, borderRadius: '50%', background: '#8b7355' }} />
-              <span>Writing entry</span>
-            </div>
-          </div>
-        </div>
-
-        {/* Right: Preview Panel */}
-        <div style={{
-          flex: '0 0 auto',
-          width: 480,
-          display: 'flex',
-          flexDirection: 'column',
-          alignItems: 'center',
-          justifyContent: 'center',
-          background: '#fffef9',
-          borderRadius: 8,
-          padding: '2rem',
-          border: '1px solid #d0c4b0',
-          boxShadow: '0 4px 12px rgba(0,0,0,0.1)',
-          transition: 'opacity 0.3s ease',
-          opacity: hoveredDay ? 1 : 0.6
-        }}>
-        {hoveredDay && currentEntry ? (
-          <>
-            {/* Polaroid-style photo */}
-            <div style={{
-              background: 'white',
-              padding: '12px 12px 40px 12px',
-              boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
-              transform: 'rotate(-2deg)',
-              marginBottom: '1.5rem',
-              position: 'relative'
-            }}>
-              <img
-                src="/ink-and-memory/placeholder-memory.png"
-                alt="Memory"
-                style={{
-                  width: '100%',
-                  maxWidth: 280,
-                  aspectRatio: '1',
-                  objectFit: 'cover',
-                  display: 'block'
-                }}
-              />
-              {/* Date label at bottom of polaroid */}
-              <div style={{
-                position: 'absolute',
-                bottom: 12,
-                left: 0,
-                right: 0,
-                textAlign: 'center',
-                fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif",
-                fontSize: 15,
-                color: '#666'
-              }}>
-                {currentYear}Âπ¥{currentMonth + 1}Êúà{hoveredDay}Êó•
-              </div>
-            </div>
-
-            {/* Text summary */}
-            <div style={{
-              fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif",
-              fontSize: 16,
-              lineHeight: 1.6,
-              color: '#333',
-              textAlign: 'center',
-              maxWidth: 320,
-              padding: '0 1rem'
-            }}>
-              {currentEntry.summary}
-            </div>
-          </>
-        ) : (
-          <div style={{
-            textAlign: 'center',
-            color: '#999',
-            fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif"
-          }}>
-            <div style={{ fontSize: 48, marginBottom: '1rem' }}>üìî</div>
-            <div style={{ fontSize: 16 }}>Hover over a date</div>
-            <div style={{ fontSize: 16 }}>to see its memory</div>
-          </div>
-        )}
-        </div>
-      </div>
-    </div>
-  );
-}
diff --git a/frontend/src/components/CalendarWidget.tsx b/frontend/src/components/CalendarWidget.tsx
deleted file mode 100644
index cdf2d76..0000000
--- a/frontend/src/components/CalendarWidget.tsx
+++ /dev/null
@@ -1,222 +0,0 @@
-import { useState, useEffect } from 'react';
-import { getCalendarData, getDateKey, getTodayKey, type CalendarEntry } from '../utils/calendarStorage';
-
-interface CalendarWidgetProps {
-  onLoadEntry: (entry: CalendarEntry) => void;
-}
-
-export default function CalendarWidget({ onLoadEntry }: CalendarWidgetProps) {
-  const [currentMonth, setCurrentMonth] = useState(new Date());
-  const [selectedDate, setSelectedDate] = useState<string | null>(null);
-  const [entriesForDate, setEntriesForDate] = useState<CalendarEntry[]>([]);
-
-  const calendarData = getCalendarData();
-  const datesWithEntries = new Set(Object.keys(calendarData));
-  const todayKey = getTodayKey();
-
-  useEffect(() => {
-    if (selectedDate) {
-      setEntriesForDate(calendarData[selectedDate] || []);
-    } else {
-      setEntriesForDate([]);
-    }
-  }, [selectedDate, calendarData]);
-
-  const getDaysInMonth = (date: Date) => {
-    const year = date.getFullYear();
-    const month = date.getMonth();
-    const firstDay = new Date(year, month, 1);
-    const lastDay = new Date(year, month + 1, 0);
-
-    const days: (Date | null)[] = [];
-
-    // Add empty slots for days before month starts
-    const startDay = firstDay.getDay();
-    for (let i = 0; i < startDay; i++) {
-      days.push(null);
-    }
-
-    // Add all days in month
-    for (let i = 1; i <= lastDay.getDate(); i++) {
-      days.push(new Date(year, month, i));
-    }
-
-    return days;
-  };
-
-  const formatMonthYear = (date: Date) => {
-    return date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
-  };
-
-  const formatTime = (timestamp: number) => {
-    return new Date(timestamp).toLocaleTimeString('en-US', {
-      hour: '2-digit',
-      minute: '2-digit',
-      hour12: false
-    });
-  };
-
-  const prevMonth = () => {
-    setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1));
-    setSelectedDate(null);
-  };
-
-  const nextMonth = () => {
-    setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1));
-    setSelectedDate(null);
-  };
-
-  const days = getDaysInMonth(currentMonth);
-
-  return (
-    <div style={{
-      padding: '20px',
-      fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif",
-    }}>
-      {/* Month navigation */}
-      <div style={{
-        display: 'flex',
-        justifyContent: 'space-between',
-        alignItems: 'center',
-        marginBottom: '16px',
-      }}>
-        <button
-          onClick={prevMonth}
-          style={{
-            background: 'none',
-            border: 'none',
-            cursor: 'pointer',
-            fontSize: '18px',
-            padding: '4px 8px',
-          }}
-        >
-          ‚Üê
-        </button>
-        <div style={{ fontSize: '16px', fontWeight: 600 }}>
-          {formatMonthYear(currentMonth)}
-        </div>
-        <button
-          onClick={nextMonth}
-          style={{
-            background: 'none',
-            border: 'none',
-            cursor: 'pointer',
-            fontSize: '18px',
-            padding: '4px 8px',
-          }}
-        >
-          ‚Üí
-        </button>
-      </div>
-
-      {/* Calendar grid */}
-      <div style={{
-        display: 'grid',
-        gridTemplateColumns: 'repeat(7, 1fr)',
-        gap: '4px',
-        marginBottom: '16px',
-      }}>
-        {/* Day headers */}
-        {['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'].map(day => (
-          <div key={day} style={{
-            textAlign: 'center',
-            fontSize: '12px',
-            color: '#666',
-            fontWeight: 600,
-            padding: '4px',
-          }}>
-            {day}
-          </div>
-        ))}
-
-        {/* Days */}
-        {days.map((day, idx) => {
-          if (!day) {
-            return <div key={`empty-${idx}`} />;
-          }
-
-          const dateKey = getDateKey(day);
-          const hasEntries = datesWithEntries.has(dateKey);
-          const isToday = dateKey === todayKey;
-          const isSelected = dateKey === selectedDate;
-
-          return (
-            <button
-              key={dateKey}
-              onClick={() => setSelectedDate(isSelected ? null : dateKey)}
-              style={{
-                padding: '8px',
-                border: isToday ? '2px solid #333' : '1px solid #ddd',
-                background: isSelected ? '#f0f0f0' : 'white',
-                cursor: 'pointer',
-                borderRadius: '4px',
-                fontSize: '14px',
-                position: 'relative',
-                textAlign: 'center',
-              }}
-            >
-              {day.getDate()}
-              {hasEntries && (
-                <div style={{
-                  position: 'absolute',
-                  bottom: '2px',
-                  left: '50%',
-                  transform: 'translateX(-50%)',
-                  width: '4px',
-                  height: '4px',
-                  borderRadius: '50%',
-                  background: '#4a90e2',
-                }} />
-              )}
-            </button>
-          );
-        })}
-      </div>
-
-      {/* Entries list */}
-      {selectedDate && entriesForDate.length > 0 && (
-        <div>
-          <div style={{
-            fontSize: '14px',
-            fontWeight: 600,
-            marginBottom: '8px',
-            color: '#333',
-          }}>
-            Entries for {selectedDate}
-          </div>
-          <div style={{
-            borderTop: '1px solid #ddd',
-            paddingTop: '8px',
-          }}>
-            {entriesForDate.map(entry => (
-              <button
-                key={entry.id}
-                onClick={() => onLoadEntry(entry)}
-                style={{
-                  width: '100%',
-                  padding: '8px',
-                  marginBottom: '4px',
-                  border: '1px solid #e0e0e0',
-                  borderRadius: '4px',
-                  background: 'white',
-                  cursor: 'pointer',
-                  textAlign: 'left',
-                  display: 'flex',
-                  gap: '8px',
-                  fontSize: '13px',
-                }}
-              >
-                <span style={{ color: '#666', minWidth: '45px' }}>
-                  {formatTime(entry.timestamp)}
-                </span>
-                <span style={{ color: '#333', flex: 1 }}>
-                  {entry.firstLine}
-                </span>
-              </button>
-            ))}
-          </div>
-        </div>
-      )}
-    </div>
-  );
-}
diff --git a/frontend/src/components/VoiceComment.tsx b/frontend/src/components/VoiceComment.tsx
deleted file mode 100644
index dfa586a..0000000
--- a/frontend/src/components/VoiceComment.tsx
+++ /dev/null
@@ -1,87 +0,0 @@
-import { useState } from 'react';
-import { FaBrain, FaHeart, FaQuestion, FaCloud, FaTheaterMasks, FaEye, FaFistRaised, FaLightbulb, FaShieldAlt, FaWind, FaFire, FaCompass } from 'react-icons/fa';
-
-interface VoiceCommentProps {
-  voice: string;
-  text: string;
-  icon: string;
-  color: string;
-  onQuote?: () => void;
-  isHovered?: boolean;
-}
-
-const iconMap = {
-  brain: FaBrain,
-  heart: FaHeart,
-  question: FaQuestion,
-  cloud: FaCloud,
-  masks: FaTheaterMasks,
-  eye: FaEye,
-  fist: FaFistRaised,
-  lightbulb: FaLightbulb,
-  shield: FaShieldAlt,
-  wind: FaWind,
-  fire: FaFire,
-  compass: FaCompass,
-};
-
-const colorMap: Record<string, { background: string; border: string }> = {
-  blue: { background: '#e6f2ff', border: '#4d9fff' },
-  pink: { background: '#ffe6f2', border: '#ff66b3' },
-  yellow: { background: '#fffbe6', border: '#ffdd33' },
-  green: { background: '#e6ffe6', border: '#66ff66' },
-  purple: { background: '#f3e6ff', border: '#b366ff' },
-};
-
-export default function VoiceComment({ voice, text, icon, color, onQuote, isHovered }: VoiceCommentProps) {
-  const Icon = iconMap[icon as keyof typeof iconMap];
-  const colors = colorMap[color] || { background: '#f0f0f0', border: '#ccc' };
-  const [isLocalHovered, setIsLocalHovered] = useState(false);
-
-  // Combined hover state (from parent highlighting OR local hover)
-  const showHoverEffect = isHovered || isLocalHovered;
-
-  return (
-    <div
-      className={`voice-comment ${showHoverEffect ? 'hovered' : ''}`}
-      onMouseEnter={() => setIsLocalHovered(true)}
-      onMouseLeave={() => setIsLocalHovered(false)}
-      onClick={onQuote}
-      style={{
-        backgroundColor: colors.background,
-        borderColor: colors.border,
-        position: 'relative',
-        transform: showHoverEffect ? 'scale(1.02)' : 'scale(1)',
-        boxShadow: showHoverEffect ? '0 4px 12px rgba(0,0,0,0.15)' : 'none',
-        transition: 'all 0.2s ease',
-        borderWidth: showHoverEffect ? '2px' : '4px',
-        cursor: onQuote ? 'pointer' : 'default',
-      }}
-    >
-      <div className="voice-header">
-        {Icon && <Icon className="voice-icon" />}
-        <strong>{voice}:</strong>
-      </div>
-      <div className="voice-text">{text}</div>
-
-      {/* Show "Click to reply" hint on hover */}
-      {onQuote && isLocalHovered && (
-        <div
-          style={{
-            position: 'absolute',
-            bottom: 8,
-            right: 8,
-            fontSize: 11,
-            color: '#888',
-            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
-            fontStyle: 'italic',
-            pointerEvents: 'none',
-            opacity: 0.8
-          }}
-        >
-          Click to reply
-        </div>
-      )}
-    </div>
-  );
-}
\ No newline at end of file
diff --git a/frontend/src/components/VoicesPanel.tsx b/frontend/src/components/VoicesPanel.tsx
deleted file mode 100644
index 96ad26d..0000000
--- a/frontend/src/components/VoicesPanel.tsx
+++ /dev/null
@@ -1,29 +0,0 @@
-import { type ReactNode, useRef, useEffect } from 'react';
-import BookPage from './BookPage';
-
-interface VoicesPanelProps {
-  children: ReactNode;
-  focusedVoiceIndex?: number;
-}
-
-export default function VoicesPanel({ children, focusedVoiceIndex }: VoicesPanelProps) {
-  const panelRef = useRef<HTMLDivElement>(null);
-
-  // @@@ Auto-scroll to focused comment with margin
-  useEffect(() => {
-    if (focusedVoiceIndex !== undefined && panelRef.current) {
-      const comments = panelRef.current.querySelectorAll('.voice-comment');
-      const targetComment = comments[focusedVoiceIndex] as HTMLElement;
-
-      if (targetComment) {
-        targetComment.scrollIntoView({ behavior: 'smooth', block: 'center' });
-      }
-    }
-  }, [focusedVoiceIndex]);
-
-  return (
-    <BookPage side="right" ref={panelRef}>
-      {children}
-    </BookPage>
-  );
-}
\ No newline at end of file
