commit 4d96e7f6bc41ceb6851402be8f143b0a57a36694
Author: lexicalmathical <lexicalmathical@gmail.com>
Date:   Wed Nov 5 15:05:09 2025 +0800

    Fix calendar entries disappearing after delete
    
    - Added missing check to skip unnamed sessions in reload logic
    - Made date extraction consistent (substring vs split)
    - Reload logic now matches initial load logic exactly
    
    This fixes the bug where all entries for a date would disappear
    after deleting one entry, requiring a page refresh to see them again.

diff --git a/frontend/src/components/CalendarPopup.tsx b/frontend/src/components/CalendarPopup.tsx
index f0f2718..e9dba6e 100644
--- a/frontend/src/components/CalendarPopup.tsx
+++ b/frontend/src/components/CalendarPopup.tsx
@@ -129,11 +129,18 @@ export default function CalendarPopup({ onLoadEntry, onClose }: Props) {
           const grouped: Record<string, CalendarEntry[]> = {};
 
           for (const session of sessions) {
+            // @@@ Skip unnamed sessions (same check as initial load)
+            if (!session.name) continue;
+
             const fullSession = await getSession(session.id);
-            let dateKey = session.created_at?.split('T')[0] || getTodayKey();
+            // @@@ Extract date from created_at timestamp (format: "2025-11-02 10:42:17")
+            let dateKey = session.created_at?.substring(0, 10) || getTodayKey();
+
+            // Legacy: if name starts with YYYY-MM-DD format, use that
             if (session.name && /^\d{4}-\d{2}-\d{2}/.test(session.name)) {
               dateKey = session.name.split(' - ')[0];
             }
+
             if (!grouped[dateKey]) {
               grouped[dateKey] = [];
             }
@@ -141,7 +148,7 @@ export default function CalendarPopup({ onLoadEntry, onClose }: Props) {
               id: session.id,
               timestamp: new Date(session.created_at || Date.now()).getTime(),
               state: fullSession.editor_state,
-              firstLine: session.name || 'Untitled'
+              firstLine: session.name
             });
           }
           setCalendarData(grouped);
diff --git a/frontend/src/components/StateChooser.tsx b/frontend/src/components/StateChooser.tsx
index c07b630..1f9c2b4 100644
--- a/frontend/src/components/StateChooser.tsx
+++ b/frontend/src/components/StateChooser.tsx
@@ -35,7 +35,7 @@ export default function StateChooser({ stateConfig, selectedState, onChoose }: P
   };
 
   // @@@ Mini icon generator for collapsed state (24px version)
-  const getMiniStateIcon = (stateId: string): JSX.Element => {
+  const getMiniStateIcon = (stateId: string) => {
     const iconProps = { width: 24, height: 24, viewBox: "0 0 100 100" };
 
     switch(stateId.toLowerCase()) {
@@ -121,7 +121,7 @@ export default function StateChooser({ stateConfig, selectedState, onChoose }: P
           >
             {/* Shrunken state icon */}
             <div style={{ flexShrink: 0, display: 'flex', alignItems: 'center' }}>
-              {getMiniStateIcon(selectedState)}
+              {selectedState && getMiniStateIcon(selectedState)}
             </div>
 
             <span style={{
diff --git a/frontend/src/components/StateCube.tsx b/frontend/src/components/StateCube.tsx
index 770a6b3..aeb5596 100644
--- a/frontend/src/components/StateCube.tsx
+++ b/frontend/src/components/StateCube.tsx
@@ -17,12 +17,17 @@ interface CubeFace {
 
 // @@@ Quaternion class for smooth 3D rotation
 class Quaternion {
-  constructor(
-    public w: number,
-    public x: number,
-    public y: number,
-    public z: number
-  ) {}
+  w: number;
+  x: number;
+  y: number;
+  z: number;
+
+  constructor(w: number, x: number, y: number, z: number) {
+    this.w = w;
+    this.x = x;
+    this.y = y;
+    this.z = z;
+  }
 
   static identity(): Quaternion {
     return new Quaternion(1, 0, 0, 0);
@@ -392,7 +397,7 @@ export function StateCube({ onStateSelect, stateConfig }: StateCubeProps) {
   }, []);
 
   // @@@ Simple SVG icon generator for each state
-  const getStateIcon = (stateId: string): JSX.Element => {
+  const getStateIcon = (stateId: string) => {
     const iconProps = { width: 40, height: 40, viewBox: "0 0 100 100", style: { margin: '0 auto' } };
 
     switch(stateId.toLowerCase()) {
@@ -455,7 +460,7 @@ export function StateCube({ onStateSelect, stateConfig }: StateCubeProps) {
           gap: '8px'
         }}
       >
-        {face.states.map((state, idx) => {
+        {face.states.map((state) => {
           const isClicked = clickedState === state.id;
           return (
             <div
