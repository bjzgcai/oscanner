commit a8e8c630cfd31960217103683c49726175b82293
Author: lexicalmathical <lexicalmathical@gmail.com>
Date:   Tue Dec 9 21:28:41 2025 +0800

    change image generation apikey to load from models.json

diff --git a/backend/config.py b/backend/config.py
index 09b5880..c06269d 100644
--- a/backend/config.py
+++ b/backend/config.py
@@ -1,5 +1,6 @@
 """Voice archetypes configuration - Echo system."""
 
+import json
 import os
 
 # Model to use for voice analysis
@@ -14,7 +15,39 @@ SINGLE_COMMENT_MODE = (
 )
 
 # @@@ Image generation configuration
-IMAGE_API_KEY = "sk-yz0JLc7sGbCHnwam70Bc9e29Dc684bAe904102C95dF32fB1"
+def _load_image_api_key() -> str:
+    """
+    Load image API key from backend/models.json; fail loudly if missing.
+
+    Expected shape:
+    {
+      "models": {
+        "gpt-5": {
+          "endpoint": "...",
+          "api_key": "...",
+          "model": "..."
+        },
+        ...
+      }
+    }
+    """
+    models_path = os.path.join(os.path.dirname(__file__), "models.json")
+    if not os.path.exists(models_path):
+        raise RuntimeError("models.json not found; image API key unavailable")
+
+    with open(models_path, "r", encoding="utf-8") as f:
+        data = json.load(f)
+
+    models = data.get("models") or {}
+    for _, cfg in models.items():
+        key = cfg.get("api_key")
+        if key:
+            return key
+
+    raise RuntimeError("No api_key found under models.* in models.json")
+
+
+IMAGE_API_KEY = _load_image_api_key()
 IMAGE_API_ENDPOINT = "https://api.dou.chat/v1"
 IMAGE_DESCRIPTION_MODEL = "anthropic/claude-haiku-4.5"
 IMAGE_GENERATION_MODEL = "google/gemini-2.5-flash-image-preview"
