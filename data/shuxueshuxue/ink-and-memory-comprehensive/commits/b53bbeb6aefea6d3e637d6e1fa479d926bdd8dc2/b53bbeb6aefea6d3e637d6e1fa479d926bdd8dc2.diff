commit b53bbeb6aefea6d3e637d6e1fa479d926bdd8dc2
Author: lexicalmathical <lexicalmathical@gmail.com>
Date:   Wed Dec 3 15:42:40 2025 +0800

    add models.json to docker image

diff --git a/.github/workflows/deploy-backend.yml b/.github/workflows/deploy-backend.yml
index a78f7f7..3fca26a 100644
--- a/.github/workflows/deploy-backend.yml
+++ b/.github/workflows/deploy-backend.yml
@@ -60,12 +60,17 @@ jobs:
             IMAGE_TAG="${{ needs.build-and-push.outputs.image_tag }}"
             cd /root/ink-and-memory/backend
             mkdir -p /root/ink-and-memory/backend/data
+            # Write models.json from secret for runtime mounting
+            cat > /root/ink-and-memory/backend/models.json <<'EOF'
+${{ secrets.MODELS_JSON }}
+EOF
             echo "${{ secrets.GHCR_PAT }}" | docker login ghcr.io -u shuxueshuxue --password-stdin >/dev/null
             docker pull "${IMAGE_TAG}"
             docker rm -f ink-backend || true
             docker run -d --name ink-backend --restart unless-stopped \
               -p 127.0.0.1:8765:8765 \
               -v /root/ink-and-memory/backend/data:/app/data \
+              -v /root/ink-and-memory/backend/models.json:/app/models.json:ro \
               -e BACKEND_VERSION=${IMAGE_TAG} \
               ${IMAGE_TAG}
             tmux kill-session -t ink-and-memory-docker 2>/dev/null || true
@@ -73,4 +78,4 @@ jobs:
             echo "--- container status ---"
             docker ps --filter "name=ink-backend" --format "name: {{.Names}} status: {{.Status}} image: {{.Image}}"
             echo "--- last 20 logs ---"
-            docker logs --tail 20 ink-backend || true
\ No newline at end of file
+            docker logs --tail 20 ink-backend || true
