commit c6ee660c5d118f1d896ebc936548e5aa6fc9a431
Author: lexicalmathical <lexicalmathical@gmail.com>
Date:   Tue Nov 18 16:12:33 2025 +0800

    Fix deck UI bugs and timeline placeholder
    
    - Fix deck names showing "0" suffix by converting is_system to boolean
    - Fix button widths: make Create Deck and Add Voice buttons auto-width
    - Fix textarea overflow by adding box-sizing: border-box
    - Set default enabled decks to only introspection deck on registration
    - Update timeline placeholder for today to show automatic generation message
    - Disable manual generation click for today's empty image slot
    
    ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
    
    Co-Authored-By: Claude <noreply@anthropic.com>

diff --git a/backend/database.py b/backend/database.py
index 1be2ea0..7fb8bfe 100644
--- a/backend/database.py
+++ b/backend/database.py
@@ -561,15 +561,22 @@ def auto_fork_system_decks(user_id: int):
         db.close()
 
     # Fork each deck (each fork opens its own connection)
+    # @@@ Only enable introspection deck by default
     for deck_id in deck_ids:
-        fork_deck(user_id, deck_id)
+        should_enable = (deck_id == 'introspection_deck')
+        fork_deck(user_id, deck_id, enabled=should_enable)
 
     print(f"‚úÖ Auto-forked {len(deck_ids)} system decks for user {user_id}")
 
-def fork_deck(user_id: int, deck_id: str) -> str:
+def fork_deck(user_id: int, deck_id: str, enabled: bool = True) -> str:
     """
     Fork a deck to create user's own copy.
     Copies deck + all voices. Returns new deck_id.
+
+    Args:
+        user_id: The user who is forking the deck
+        deck_id: ID of the deck to fork
+        enabled: Whether the forked deck should be enabled (default: True)
     """
     import uuid
 
@@ -587,7 +594,7 @@ def fork_deck(user_id: int, deck_id: str) -> str:
         db.execute("""
         INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en,
                           icon, color, is_system, parent_id, owner_id, enabled, has_local_changes, order_index)
-        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, 1, 0, ?)
+        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, ?, 0, ?)
         """, (new_deck_id,
               source_deck['name'],
               source_deck['name_zh'],
@@ -599,6 +606,7 @@ def fork_deck(user_id: int, deck_id: str) -> str:
               source_deck['color'],
               deck_id,  # parent_id tracks fork source
               user_id,
+              1 if enabled else 0,  # @@@ enabled parameter
               source_deck['order_index']))
 
         # Copy all voices
diff --git a/frontend/src/components/CollectionsView.tsx b/frontend/src/components/CollectionsView.tsx
index ae3c93a..b90758f 100644
--- a/frontend/src/components/CollectionsView.tsx
+++ b/frontend/src/components/CollectionsView.tsx
@@ -146,7 +146,7 @@ function generateTimelineDays(): TimelineDay[] {
 
 // @@@ Helper function for interesting placeholders
 function getPlaceholderText(daysOffset: number): string {
-  if (daysOffset === 0) return 'Click to generate';
+  if (daysOffset === 0) return 'Generates automatically overnight';
 
   const placeholders: Record<string, string> = {
     '-7': 'taste buds renew every 10 days',
@@ -635,9 +635,8 @@ function TimelinePage({ isVisible, voiceConfigs }: { isVisible: boolean; voiceCo
                 onClick={() => {
                   if (dayData?.picture) {
                     handleImageClick(dayData.picture);
-                  } else if (day.isToday && !isGenerating) {
-                    handleGenerateForDate(day.date);
                   }
+                  // @@@ Removed manual generation for today - now automatic only
                 }}
                 style={{
                   display: 'flex',
@@ -647,12 +646,12 @@ function TimelinePage({ isVisible, voiceConfigs }: { isVisible: boolean; voiceCo
                   border: '1px solid #d0c4b0',
                   borderRadius: '8px',
                   padding: '1rem',
-                  cursor: (dayData?.picture || day.isToday) && !isGenerating ? 'pointer' : 'default',
+                  cursor: dayData?.picture && !isGenerating ? 'pointer' : 'default',
                   transition: 'transform 0.2s, box-shadow 0.2s',
                   opacity: day.isPast && !hasData ? 0.4 : 1
                 }}
                 onMouseEnter={e => {
-                  if ((dayData?.picture || day.isToday) && !isGenerating) {
+                  if (dayData?.picture && !isGenerating) {
                     e.currentTarget.style.transform = 'translateX(8px)';
                     e.currentTarget.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
                   }
@@ -746,9 +745,11 @@ function TimelinePage({ isVisible, voiceConfigs }: { isVisible: boolean; voiceCo
                   <div style={{
                     fontSize: '13px',
                     color: '#888',
-                    fontStyle: textByDate.get(day.date) ? 'normal' : 'italic'
+                    fontStyle: (day.isToday && !dayData?.picture) || (!textByDate.get(day.date) && !dayData?.comments?.length) ? 'italic' : 'normal'
                   }}>
                     {isGenerating ? 'Generating...' :
+                     day.isToday && !dayData?.picture ?
+                       getPlaceholderText(day.daysOffset) :
                      textByDate.get(day.date) ?
                        getTextPreview(textByDate.get(day.date)!) :
                      dayData?.comments?.length ?
diff --git a/frontend/src/components/DeckManager.tsx b/frontend/src/components/DeckManager.tsx
index 8bb55e6..51f51b0 100644
--- a/frontend/src/components/DeckManager.tsx
+++ b/frontend/src/components/DeckManager.tsx
@@ -1,4 +1,4 @@
-import { useState, useEffect } from 'react';
+import { useState, useEffect, useRef } from 'react';
 import {
   listDecks,
   getDeck,
@@ -11,6 +11,7 @@ import {
   updateVoice,
   deleteVoice,
   forkVoice,
+  publishDeck,
   type Deck,
   type Voice
 } from '../api/voiceApi';
@@ -67,18 +68,34 @@ interface Props {
 
 export default function DeckManager({ onUpdate }: Props) {
   const [decks, setDecks] = useState<Deck[]>([]);
+  const [communityDecks, setCommunityDecks] = useState<Deck[]>([]);
   const [expandedDecks, setExpandedDecks] = useState<Set<string>>(new Set());
   const [loading, setLoading] = useState(true);
   const [error, setError] = useState<string | null>(null);
   const [editingVoice, setEditingVoice] = useState<string | null>(null);
+  const [editingField, setEditingField] = useState<'name' | 'prompt' | null>(null);
+  const [creatingDeck, setCreatingDeck] = useState(false);
+  const [creatingVoice, setCreatingVoice] = useState<string | null>(null);
+  const [publishWarning, setPublishWarning] = useState<string | null>(null);
+
+  // @@@ Scroll position preservation
+  const scrollContainerRef = useRef<HTMLDivElement>(null);
 
   useEffect(() => {
     loadDecks();
+    loadCommunityDecks();
   }, []);
 
-  async function loadDecks() {
+  async function loadDecks(preserveScroll = false) {
+    // @@@ Save scroll position before reload
+    const savedScrollTop = preserveScroll && scrollContainerRef.current
+      ? scrollContainerRef.current.scrollTop
+      : 0;
+
     try {
-      setLoading(true);
+      if (!preserveScroll) {
+        setLoading(true);
+      }
       const fetchedDecks = await listDecks();
 
       // Load voices for each deck
@@ -95,11 +112,22 @@ export default function DeckManager({ onUpdate }: Props) {
 
       setDecks(decksWithVoices);
       setError(null);
+
+      // @@@ Restore scroll position after render
+      if (preserveScroll && scrollContainerRef.current) {
+        setTimeout(() => {
+          if (scrollContainerRef.current) {
+            scrollContainerRef.current.scrollTop = savedScrollTop;
+          }
+        }, 0);
+      }
     } catch (err: any) {
       console.error('Failed to load decks:', err);
       setError(err.message || 'Failed to load decks');
     } finally {
-      setLoading(false);
+      if (!preserveScroll) {
+        setLoading(false);
+      }
     }
   }
 
@@ -118,7 +146,7 @@ export default function DeckManager({ onUpdate }: Props) {
   async function handleForkDeck(deckId: string) {
     try {
       await forkDeck(deckId);
-      await loadDecks();
+      await loadDecks(true);
       onUpdate?.();
     } catch (err: any) {
       alert(`Failed to fork deck: ${err.message}`);
@@ -128,7 +156,7 @@ export default function DeckManager({ onUpdate }: Props) {
   async function handleToggleDeck(deckId: string, currentEnabled: boolean) {
     try {
       await updateDeck(deckId, { enabled: !currentEnabled });
-      await loadDecks();
+      await loadDecks(true);
       onUpdate?.();
     } catch (err: any) {
       alert(`Failed to toggle deck: ${err.message}`);
@@ -140,7 +168,7 @@ export default function DeckManager({ onUpdate }: Props) {
 
     try {
       await deleteDeck(deckId);
-      await loadDecks();
+      await loadDecks(true);
       onUpdate?.();
     } catch (err: any) {
       alert(`Failed to delete deck: ${err.message}`);
@@ -153,7 +181,7 @@ export default function DeckManager({ onUpdate }: Props) {
     try {
       const result = await syncDeck(deckId);
       alert(`‚úÖ Synced ${result.synced_voices} voices with original template`);
-      await loadDecks();
+      await loadDecks(true);
       onUpdate?.();
     } catch (err: any) {
       alert(`Failed to sync deck: ${err.message}`);
@@ -163,7 +191,7 @@ export default function DeckManager({ onUpdate }: Props) {
   async function handleToggleVoice(voiceId: string, currentEnabled: boolean) {
     try {
       await updateVoice(voiceId, { enabled: !currentEnabled });
-      await loadDecks();
+      await loadDecks(true);
       onUpdate?.();
     } catch (err: any) {
       alert(`Failed to toggle voice: ${err.message}`);
@@ -173,7 +201,7 @@ export default function DeckManager({ onUpdate }: Props) {
   async function handleUpdateVoice(voiceId: string, data: Partial<Voice>) {
     try {
       await updateVoice(voiceId, data);
-      await loadDecks();
+      await loadDecks(true);
       setEditingVoice(null);
       onUpdate?.();
     } catch (err: any) {
@@ -186,13 +214,94 @@ export default function DeckManager({ onUpdate }: Props) {
 
     try {
       await deleteVoice(voiceId);
-      await loadDecks();
+      await loadDecks(true);
       onUpdate?.();
     } catch (err: any) {
       alert(`Failed to delete voice: ${err.message}`);
     }
   }
 
+  async function loadCommunityDecks() {
+    try {
+      const published = await listDecks(true);
+      setCommunityDecks(published);
+    } catch (err: any) {
+      console.error('Failed to load community decks:', err);
+    }
+  }
+
+  async function handleCreateDeck() {
+    setCreatingDeck(true);
+    try {
+      const newDeck = await createDeck({
+        name: 'New Deck',
+        description: 'Describe your deck here',
+        icon: 'brain',
+        color: 'blue'
+      });
+      await loadDecks(true);
+      setExpandedDecks(prev => new Set([...prev, newDeck.id]));
+      onUpdate?.();
+    } catch (err: any) {
+      alert(`Failed to create deck: ${err.message}`);
+    } finally {
+      setCreatingDeck(false);
+    }
+  }
+
+  async function handleAddVoice(deckId: string) {
+    setCreatingVoice(deckId);
+    try {
+      await createVoice({
+        deck_id: deckId,
+        name: 'New Voice',
+        system_prompt: 'You are a helpful assistant.',
+        icon: 'brain',
+        color: 'blue'
+      });
+      await loadDecks(true);
+      onUpdate?.();
+    } catch (err: any) {
+      alert(`Failed to create voice: ${err.message}`);
+    } finally {
+      setCreatingVoice(null);
+    }
+  }
+
+  async function handlePublishClick(deck: Deck) {
+    if (deck.published) {
+      handlePublishToggle(deck.id, false);
+    } else {
+      setPublishWarning(deck.id);
+    }
+  }
+
+  async function handlePublishToggle(deckId: string, shouldPublish: boolean) {
+    try {
+      const result = await publishDeck(deckId);
+      alert(result.published ? '‚úÖ Deck published to community!' : '‚úÖ Deck unpublished');
+      await loadDecks(true);
+      await loadCommunityDecks();
+      onUpdate?.();
+    } catch (err: any) {
+      alert(`Failed: ${err.message}`);
+    } finally {
+      setPublishWarning(null);
+    }
+  }
+
+  async function handleInstallDeck(deckId: string) {
+    try {
+      await forkDeck(deckId);
+      alert('‚úÖ Deck installed to your collection!');
+      await loadDecks(true);
+      await loadCommunityDecks();
+      onUpdate?.();
+    } catch (err: any) {
+      alert(`Failed to install deck: ${err.message}`);
+    }
+  }
+
   if (loading) {
     return (
       <div style={{
@@ -266,11 +375,50 @@ export default function DeckManager({ onUpdate }: Props) {
       </div>
 
       {/* Scrollable Content */}
-      <div style={{ flex: 1, overflowY: 'auto', padding: '32px' }}>
+      <div ref={scrollContainerRef} style={{ flex: 1, overflowY: 'auto', padding: '32px' }}>
         <div style={{ maxWidth: 1200, margin: '0 auto', display: 'flex', flexDirection: 'column', gap: 24 }}>
+          {/* Create New Deck Button */}
+          <button
+            onClick={handleCreateDeck}
+            disabled={creatingDeck}
+            style={{
+              padding: '12px 24px',
+              marginBottom: '8px',
+              background: '#4a90e2',
+              color: 'white',
+              border: 'none',
+              borderRadius: '8px',
+              cursor: creatingDeck ? 'not-allowed' : 'pointer',
+              fontSize: '14px',
+              fontWeight: '500',
+              opacity: creatingDeck ? 0.6 : 1,
+              transition: 'all 0.2s ease',
+              alignSelf: 'flex-start'
+            }}
+            onMouseEnter={(e) => {
+              if (!creatingDeck) e.currentTarget.style.background = '#357abd';
+            }}
+            onMouseLeave={(e) => {
+              if (!creatingDeck) e.currentTarget.style.background = '#4a90e2';
+            }}
+          >
+            {creatingDeck ? 'Creating...' : '+ Create New Deck'}
+          </button>
+
+          {/* My Decks Section Header */}
+          <h3 style={{
+            margin: '8px 0',
+            fontSize: '16px',
+            fontWeight: '500',
+            color: '#2c2c2c'
+          }}>
+            My Decks
+          </h3>
+
+          {/* User's Decks */}
           {decks.map(deck => {
             const isExpanded = expandedDecks.has(deck.id);
-            const isSystem = deck.is_system;
+            const isSystem = !!deck.is_system; // @@@ Convert to boolean to prevent React from rendering "0"
             const Icon = iconMap[deck.icon as keyof typeof iconMap] || FaBrain;
             const colorHex = COLORS[deck.color as keyof typeof COLORS]?.hex || '#4a90e2';
 
@@ -334,7 +482,6 @@ export default function DeckManager({ onUpdate }: Props) {
                       color: '#2c2c2c',
                       marginBottom: 4
                     }}>
-                      {console.log('üîç Rendering deck:', deck.name, 'order_index:', deck.order_index, 'full deck:', deck)}
                       {deck.name}
                       {isSystem && (
                         <span style={{
@@ -449,6 +596,32 @@ export default function DeckManager({ onUpdate }: Props) {
                             Sync with Original
                           </button>
                         )}
+                        {/* @@@ Publish button for user-owned decks */}
+                        <button
+                          onClick={() => handlePublishClick(deck)}
+                          style={{
+                            padding: '8px 16px',
+                            background: deck.published ? '#e74c3c' : '#9b59b6',
+                            color: '#fff',
+                            border: 'none',
+                            borderRadius: 6,
+                            cursor: 'pointer',
+                            fontSize: 13,
+                            fontWeight: 600,
+                            transition: 'all 0.2s'
+                          }}
+                          onMouseEnter={(e) => {
+                            e.currentTarget.style.transform = 'translateY(-1px)';
+                            const color = deck.published ? 'rgba(231, 76, 60, 0.4)' : 'rgba(155, 89, 182, 0.4)';
+                            e.currentTarget.style.boxShadow = `0 4px 12px ${color}`;
+                          }}
+                          onMouseLeave={(e) => {
+                            e.currentTarget.style.transform = 'translateY(0)';
+                            e.currentTarget.style.boxShadow = 'none';
+                          }}
+                        >
+                          {deck.published ? 'Unpublish' : 'Publish to Community'}
+                        </button>
                         <button
                           onClick={() => handleDeleteDeck(deck.id)}
                           style={{
@@ -479,14 +652,15 @@ export default function DeckManager({ onUpdate }: Props) {
                 </div>
 
                 {/* Voices List (Expanded) */}
-                {isExpanded && deck.voices && deck.voices.length > 0 && (
+                {isExpanded && (
                   <div style={{ padding: 20, background: '#fafafa' }}>
-                    <div style={{
-                      display: 'grid',
-                      gridTemplateColumns: 'repeat(auto-fill, minmax(340px, 1fr))',
-                      gap: 16
-                    }}>
-                      {deck.voices.map(voice => {
+                    {deck.voices && deck.voices.length > 0 && (
+                      <div style={{
+                        display: 'grid',
+                        gridTemplateColumns: 'repeat(auto-fill, minmax(340px, 1fr))',
+                        gap: 16
+                      }}>
+                        {deck.voices.map(voice => {
                         const VoiceIcon = iconMap[voice.icon as keyof typeof iconMap] || FaBrain;
                         const voiceColor = COLORS[voice.color as keyof typeof COLORS]?.hex || '#4a90e2';
                         const isEditing = editingVoice === voice.id;
@@ -522,16 +696,63 @@ export default function DeckManager({ onUpdate }: Props) {
                               </div>
 
                               <div style={{ flex: 1, minWidth: 0 }}>
-                                <div style={{
-                                  fontSize: 16,
-                                  fontWeight: 600,
-                                  color: '#2c2c2c',
-                                  overflow: 'hidden',
-                                  textOverflow: 'ellipsis',
-                                  whiteSpace: 'nowrap'
-                                }}>
-                                  {voice.name}
-                                </div>
+                                {/* @@@ Inline editing for voice name */}
+                                {!isEditing || editingField !== 'name' ? (
+                                  <div
+                                    onClick={() => {
+                                      if (!isSystem) {
+                                        setEditingVoice(voice.id);
+                                        setEditingField('name');
+                                      }
+                                    }}
+                                    style={{
+                                      fontSize: 16,
+                                      fontWeight: 600,
+                                      color: '#2c2c2c',
+                                      overflow: 'hidden',
+                                      textOverflow: 'ellipsis',
+                                      whiteSpace: 'nowrap',
+                                      cursor: isSystem ? 'default' : 'pointer',
+                                      transition: 'opacity 0.2s'
+                                    }}
+                                    onMouseEnter={(e) => {
+                                      if (!isSystem) e.currentTarget.style.opacity = '0.7';
+                                    }}
+                                    onMouseLeave={(e) => {
+                                      if (!isSystem) e.currentTarget.style.opacity = '1';
+                                    }}
+                                  >
+                                    {voice.name}
+                                  </div>
+                                ) : (
+                                  <input
+                                    autoFocus
+                                    defaultValue={voice.name}
+                                    onBlur={(e) => {
+                                      handleUpdateVoice(voice.id, { name: e.target.value });
+                                      setEditingVoice(null);
+                                      setEditingField(null);
+                                    }}
+                                    onKeyDown={(e) => {
+                                      if (e.key === 'Enter') {
+                                        e.currentTarget.blur();
+                                      } else if (e.key === 'Escape') {
+                                        setEditingVoice(null);
+                                        setEditingField(null);
+                                      }
+                                    }}
+                                    style={{
+                                      width: '100%',
+                                      fontSize: 16,
+                                      fontWeight: 600,
+                                      color: '#2c2c2c',
+                                      padding: '4px 8px',
+                                      border: '2px solid #4a90e2',
+                                      borderRadius: 4,
+                                      background: '#f0f8ff'
+                                    }}
+                                  />
+                                )}
                               </div>
 
                               {/* @@@ Voice-level toggle switch */}
@@ -593,42 +814,327 @@ export default function DeckManager({ onUpdate }: Props) {
                               )}
                             </div>
 
-                            {/* Voice Prompt */}
-                            <div style={{
-                              fontSize: 12,
-                              color: '#666',
-                              lineHeight: 1.6,
-                              overflow: 'hidden',
-                              textOverflow: 'ellipsis',
-                              display: '-webkit-box',
-                              WebkitLineClamp: 3,
-                              WebkitBoxOrient: 'vertical'
-                            }}>
-                              {voice.system_prompt}
-                            </div>
+                            {/* Voice Prompt with inline editing */}
+                            {!isEditing || editingField !== 'prompt' ? (
+                              <div
+                                onClick={() => {
+                                  if (!isSystem) {
+                                    setEditingVoice(voice.id);
+                                    setEditingField('prompt');
+                                  }
+                                }}
+                                style={{
+                                  fontSize: 12,
+                                  color: '#666',
+                                  lineHeight: 1.6,
+                                  overflow: 'hidden',
+                                  textOverflow: 'ellipsis',
+                                  display: '-webkit-box',
+                                  WebkitLineClamp: 3,
+                                  WebkitBoxOrient: 'vertical',
+                                  cursor: isSystem ? 'default' : 'pointer',
+                                  transition: 'opacity 0.2s'
+                                }}
+                                onMouseEnter={(e) => {
+                                  if (!isSystem) e.currentTarget.style.opacity = '0.7';
+                                }}
+                                onMouseLeave={(e) => {
+                                  if (!isSystem) e.currentTarget.style.opacity = '1';
+                                }}
+                              >
+                                {voice.system_prompt}
+                              </div>
+                            ) : (
+                              <>
+                                <textarea
+                                  autoFocus
+                                  defaultValue={voice.system_prompt}
+                                  onBlur={(e) => {
+                                    handleUpdateVoice(voice.id, { system_prompt: e.target.value });
+                                    setEditingVoice(null);
+                                    setEditingField(null);
+                                  }}
+                                  onKeyDown={(e) => {
+                                    if (e.key === 'Escape') {
+                                      setEditingVoice(null);
+                                      setEditingField(null);
+                                    }
+                                  }}
+                                  style={{
+                                    width: '100%',
+                                    minHeight: '100px',
+                                    fontSize: 12,
+                                    color: '#2c2c2c',
+                                    padding: '8px',
+                                    border: '2px solid #4a90e2',
+                                    borderRadius: 4,
+                                    background: '#f0f8ff',
+                                    fontFamily: 'inherit',
+                                    lineHeight: 1.6,
+                                    resize: 'vertical',
+                                    boxSizing: 'border-box'
+                                  }}
+                                />
+                                <div style={{
+                                  fontSize: 11,
+                                  color: '#999',
+                                  marginTop: 4
+                                }}>
+                                  {voice.system_prompt.length} chars ¬∑ Press Esc to cancel
+                                </div>
+                              </>
+                            )}
                           </div>
                         );
-                      })}
-                    </div>
-                  </div>
-                )}
+                        })}
+                      </div>
+                    )}
 
-                {/* Empty State */}
-                {isExpanded && (!deck.voices || deck.voices.length === 0) && (
-                  <div style={{
-                    padding: 32,
-                    textAlign: 'center',
-                    color: '#999',
-                    fontStyle: 'italic'
-                  }}>
-                    No voices in this deck yet
+                    {/* @@@ Add Voice button */}
+                    {!isSystem && (
+                      <button
+                        onClick={() => handleAddVoice(deck.id)}
+                        disabled={creatingVoice === deck.id}
+                        style={{
+                          padding: '8px 16px',
+                          marginTop: '16px',
+                          background: 'transparent',
+                          color: '#4a90e2',
+                          border: '1px dashed #4a90e2',
+                          borderRadius: '4px',
+                          cursor: creatingVoice === deck.id ? 'not-allowed' : 'pointer',
+                          fontSize: '12px',
+                          opacity: creatingVoice === deck.id ? 0.6 : 1,
+                          transition: 'all 0.2s',
+                          alignSelf: 'flex-start'
+                        }}
+                        onMouseEnter={(e) => {
+                          if (creatingVoice !== deck.id) {
+                            e.currentTarget.style.background = '#f0f8ff';
+                          }
+                        }}
+                        onMouseLeave={(e) => {
+                          if (creatingVoice !== deck.id) {
+                            e.currentTarget.style.background = 'transparent';
+                          }
+                        }}
+                      >
+                        {creatingVoice === deck.id ? 'Adding...' : '+ Add Voice to this Deck'}
+                      </button>
+                    )}
+
+                    {/* Empty State */}
+                    {(!deck.voices || deck.voices.length === 0) && (
+                      <div style={{
+                        padding: 32,
+                        textAlign: 'center',
+                        color: '#999',
+                        fontStyle: 'italic'
+                      }}>
+                        No voices in this deck yet
+                      </div>
+                    )}
                   </div>
                 )}
               </div>
             );
           })}
+
+          {/* @@@ Community Decks Section */}
+          <hr style={{ margin: '32px 0', border: '1px solid #d0c4b0' }} />
+
+          <h3 style={{
+            margin: '16px 0',
+            fontSize: '16px',
+            fontWeight: '500',
+            color: '#2c2c2c'
+          }}>
+            Community Decks ({communityDecks.length})
+          </h3>
+
+          {communityDecks.length === 0 ? (
+            <p style={{
+              color: '#999',
+              fontSize: '14px',
+              fontStyle: 'italic',
+              textAlign: 'center',
+              padding: '32px 0'
+            }}>
+              No published decks yet. Be the first to share!
+            </p>
+          ) : (
+            <div style={{ display: 'flex', flexDirection: 'column', gap: 16 }}>
+              {communityDecks.map(deck => {
+                const Icon = iconMap[deck.icon as keyof typeof iconMap] || FaBrain;
+                const colorHex = COLORS[deck.color as keyof typeof COLORS]?.hex || '#4a90e2';
+
+                return (
+                  <div
+                    key={deck.id}
+                    style={{
+                      background: '#fff',
+                      border: `2px solid ${colorHex}`,
+                      borderRadius: 12,
+                      padding: 20,
+                      boxShadow: '0 4px 12px rgba(0,0,0,0.1)',
+                      transition: 'all 0.3s'
+                    }}
+                  >
+                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                      <div style={{ display: 'flex', alignItems: 'center', gap: 16, flex: 1 }}>
+                        {/* Deck Icon */}
+                        <div style={{
+                          width: 56,
+                          height: 56,
+                          borderRadius: 28,
+                          background: `linear-gradient(135deg, ${colorHex} 0%, ${colorHex}cc 100%)`,
+                          display: 'flex',
+                          alignItems: 'center',
+                          justifyContent: 'center',
+                          color: '#fff',
+                          flexShrink: 0,
+                          boxShadow: `0 3px 8px ${colorHex}40`
+                        }}>
+                          <Icon size={28} />
+                        </div>
+
+                        <div style={{ flex: 1, minWidth: 0 }}>
+                          <div style={{
+                            fontSize: 18,
+                            fontWeight: 700,
+                            color: '#2c2c2c',
+                            marginBottom: 4
+                          }}>
+                            {deck.name}
+                          </div>
+                          <div style={{
+                            fontSize: 14,
+                            color: '#666',
+                            marginBottom: 4
+                          }}>
+                            {deck.description || 'No description'}
+                          </div>
+                          <div style={{
+                            fontSize: 12,
+                            color: '#999'
+                          }}>
+                            by {deck.author_name || 'Anonymous'} ¬∑ {deck.voice_count || 0} voices ¬∑ {deck.install_count || 0} installs
+                          </div>
+                        </div>
+                      </div>
+
+                      <button
+                        onClick={() => handleInstallDeck(deck.id)}
+                        style={{
+                          padding: '8px 16px',
+                          background: '#27ae60',
+                          color: '#fff',
+                          border: 'none',
+                          borderRadius: 6,
+                          fontSize: 13,
+                          fontWeight: 600,
+                          cursor: 'pointer',
+                          transition: 'all 0.2s',
+                          flexShrink: 0
+                        }}
+                        onMouseEnter={(e) => {
+                          e.currentTarget.style.transform = 'translateY(-1px)';
+                          e.currentTarget.style.boxShadow = '0 4px 12px rgba(39, 174, 96, 0.4)';
+                        }}
+                        onMouseLeave={(e) => {
+                          e.currentTarget.style.transform = 'translateY(0)';
+                          e.currentTarget.style.boxShadow = 'none';
+                        }}
+                      >
+                        Install
+                      </button>
+                    </div>
+                  </div>
+                );
+              })}
+            </div>
+          )}
         </div>
       </div>
+
+      {/* @@@ Publish Warning Modal */}
+      {publishWarning && (
+        <div
+          className="modal-overlay"
+          style={{
+            position: 'fixed',
+            top: 0,
+            left: 0,
+            right: 0,
+            bottom: 0,
+            background: 'rgba(0,0,0,0.5)',
+            display: 'flex',
+            alignItems: 'center',
+            justifyContent: 'center',
+            zIndex: 9999
+          }}
+          onClick={() => setPublishWarning(null)}
+        >
+          <div
+            className="modal-content"
+            style={{
+              background: 'white',
+              padding: '24px',
+              borderRadius: '8px',
+              maxWidth: '400px',
+              boxShadow: '0 4px 12px rgba(0,0,0,0.15)'
+            }}
+            onClick={(e) => e.stopPropagation()}
+          >
+            <h3 style={{ marginBottom: '16px', fontSize: '18px', fontWeight: 600 }}>
+              ‚ö†Ô∏è Publish Deck Warning
+            </h3>
+
+            <p style={{ marginBottom: '16px', lineHeight: '1.5', fontSize: '14px' }}>
+              Publishing will <strong>break the parent link</strong>. This deck will become
+              a standalone deck in the community store.
+            </p>
+
+            <p style={{ marginBottom: '16px', color: '#e74c3c', fontSize: '13px', lineHeight: '1.5' }}>
+              This action cannot be undone. You can unpublish later, but the parent
+              link will remain broken.
+            </p>
+
+            <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>
+              <button
+                onClick={() => setPublishWarning(null)}
+                style={{
+                  padding: '8px 16px',
+                  background: '#ccc',
+                  color: '#2c2c2c',
+                  border: 'none',
+                  borderRadius: '4px',
+                  cursor: 'pointer',
+                  fontSize: '14px',
+                  fontWeight: 500
+                }}
+              >
+                Cancel
+              </button>
+              <button
+                onClick={() => handlePublishToggle(publishWarning, true)}
+                style={{
+                  padding: '8px 16px',
+                  background: '#9b59b6',
+                  color: 'white',
+                  border: 'none',
+                  borderRadius: '4px',
+                  cursor: 'pointer',
+                  fontSize: '14px',
+                  fontWeight: 500
+                }}
+              >
+                Publish Anyway
+              </button>
+            </div>
+          </div>
+        </div>
+      )}
     </div>
   );
 }
