{
  "sha": "36b426fda4439133da58ae643f937a3d3bf23ce9",
  "node_id": "C_kwDOP2Zrm9oAKDM2YjQyNmZkYTQ0MzkxMzNkYTU4YWU2NDNmOTM3YTNkM2JmMjNjZTk",
  "commit": {
    "author": {
      "name": "lexicalmathical",
      "email": "lexicalmathical@gmail.com",
      "date": "2025-12-09T08:57:54Z"
    },
    "committer": {
      "name": "lexicalmathical",
      "email": "lexicalmathical@gmail.com",
      "date": "2025-12-09T08:57:54Z"
    },
    "message": "correct word counting",
    "tree": {
      "sha": "e4368bc464c760f1fff491ffb7af9d47862691fe",
      "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/git/trees/e4368bc464c760f1fff491ffb7af9d47862691fe"
    },
    "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/git/commits/36b426fda4439133da58ae643f937a3d3bf23ce9",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null,
      "verified_at": null
    }
  },
  "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/commits/36b426fda4439133da58ae643f937a3d3bf23ce9",
  "html_url": "https://github.com/shuxueshuxue/ink-and-memory/commit/36b426fda4439133da58ae643f937a3d3bf23ce9",
  "comments_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/commits/36b426fda4439133da58ae643f937a3d3bf23ce9/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "1043d30fdb4e5797b0ae6c01722079439364ff23",
      "url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/commits/1043d30fdb4e5797b0ae6c01722079439364ff23",
      "html_url": "https://github.com/shuxueshuxue/ink-and-memory/commit/1043d30fdb4e5797b0ae6c01722079439364ff23"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 18,
    "deletions": 1
  },
  "files": [
    {
      "sha": "c9f6e92cbe8801fb49eb1a27986ed583be62f1b2",
      "filename": "backend/server.py",
      "status": "modified",
      "additions": 18,
      "deletions": 1,
      "changes": 19,
      "blob_url": "https://github.com/shuxueshuxue/ink-and-memory/blob/36b426fda4439133da58ae643f937a3d3bf23ce9/backend%2Fserver.py",
      "raw_url": "https://github.com/shuxueshuxue/ink-and-memory/raw/36b426fda4439133da58ae643f937a3d3bf23ce9/backend%2Fserver.py",
      "contents_url": "https://api.github.com/repos/shuxueshuxue/ink-and-memory/contents/backend%2Fserver.py?ref=36b426fda4439133da58ae643f937a3d3bf23ce9",
      "patch": "@@ -39,6 +39,23 @@ def normalize_language_code(language: Optional[str]) -> str:\n     return \"en\"\n \n \n+def _count_mixed_words(text: str) -> int:\n+    \"\"\"\n+    Count words in mixed Chinese/English text.\n+    - CJK characters count as 1 each\n+    - English is counted by whitespace-separated tokens\n+    \"\"\"\n+    word_count = 0\n+    for ch in text:\n+        code = ord(ch)\n+        if (0x4E00 <= code <= 0x9FFF or 0x3400 <= code <= 0x4DBF or 0x3040 <= code <= 0x309F or 0x30A0 <= code <= 0x30FF):\n+            word_count += 1\n+    import re\n+    english_words = re.sub(r\"[\\u4E00-\\u9FFF\\u3400-\\u4DBF\\u3040-\\u309F\\u30A0-\\u30FF]\", \" \", text)\n+    word_count += len([w for w in english_words.split() if w])\n+    return word_count\n+\n+\n \n \n def _load_all_notes_text(user_id: int) -> str:\n@@ -1273,7 +1290,7 @@ def get_sessions_aggregate(timezone: str = \"Asia/Shanghai\", current_user: dict =\n         text = s.get(\"text\", \"\") or \"\"\n         if text.strip():\n             total_entries += 1\n-            total_words += len(text.split())\n+            total_words += _count_mixed_words(text)\n         # derive local date from updated_at or created_at\n         ts_raw = s.get(\"updated_at\") or s.get(\"created_at\")\n         if ts_raw:"
    }
  ]
}