commit 681162b0353f059197c4c3057d35306cbd3f5bf4
Author: lexicalmathical <lexicalmathical@gmail.com>
Date:   Wed Nov 5 16:36:04 2025 +0800

    Add greeting comment feature for daily state selection
    
    - Add greeting field to UserState type
    - Add state-specific greeting messages (happy/ok/unhappy)
    - Create greeting comment automatically when user selects daily state
    - Greeting comments use empty phrase ('') as marker
    - Render greeting comments at top of editor above text cells
    - Greeting uses first available voice persona
    
    ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
    
    Co-Authored-By: Claude <noreply@anthropic.com>

diff --git a/frontend/src/App.tsx b/frontend/src/App.tsx
index 885ac2c..af2c38a 100644
--- a/frontend/src/App.tsx
+++ b/frontend/src/App.tsx
@@ -1080,7 +1080,28 @@ export default function App() {
       localStorage.setItem(STORAGE_KEYS.SELECTED_STATE, stateId);
       localStorage.setItem('selected-state-date', today);
     }
-  }, [isAuthenticated]);
+
+    // @@@ Add greeting comment for first daily state selection
+    if (engineRef.current && stateConfig.states[stateId]) {
+      const greetingText = stateConfig.states[stateId].greeting;
+      const firstVoice = Object.keys(voiceConfigs)[0]; // Use first voice for greeting
+
+      if (greetingText && firstVoice) {
+        const greetingComment: Commentor = {
+          id: `greeting-${Date.now()}`,
+          phrase: '', // Empty phrase marks this as a greeting comment
+          voice: voiceConfigs[firstVoice].name,
+          comment: greetingText,
+          appliedAt: Date.now(),
+          icon: voiceConfigs[firstVoice].icon,
+          color: voiceConfigs[firstVoice].color
+        };
+
+        engineRef.current.addCommentToState(greetingComment);
+        setState(engineRef.current.getState());
+      }
+    }
+  }, [isAuthenticated, stateConfig, voiceConfigs, engineRef]);
 
   const handleVoiceConfigsSave = useCallback(async (data: {
     voices: Record<string, VoiceConfig>;
@@ -1836,6 +1857,48 @@ export default function App() {
                     />
                   </div>
 
+                  {/* @@@ Greeting comments (phrase === '') - rendered at top */}
+                  {state.commentors
+                    .filter(c => c.appliedAt && c.phrase === '')
+                    .map((greetingComment) => (
+                      <div
+                        key={greetingComment.id}
+                        style={{
+                          marginBottom: '20px',
+                          padding: '12px 16px',
+                          background: 'rgba(255, 255, 255, 0.95)',
+                          border: '1px solid rgba(0,0,0,0.1)',
+                          borderRadius: '8px',
+                          boxShadow: '0 2px 6px rgba(0,0,0,0.08)',
+                          fontFamily: "'Excalifont', 'Xiaolai', 'Georgia', serif"
+                        }}
+                      >
+                        <div style={{
+                          display: 'flex',
+                          alignItems: 'flex-start',
+                          gap: '8px'
+                        }}>
+                          <span style={{ fontSize: '18px' }}>
+                            {greetingComment.icon}
+                          </span>
+                          <div style={{ flex: 1 }}>
+                            <strong style={{
+                              color: greetingComment.color === 'blue' ? '#4A90E2' :
+                                     greetingComment.color === 'pink' ? '#E91E63' :
+                                     greetingComment.color === 'yellow' ? '#FFC107' :
+                                     greetingComment.color === 'green' ? '#4CAF50' :
+                                     greetingComment.color === 'purple' ? '#9C27B0' : '#333'
+                            }}>
+                              {greetingComment.voice}:
+                            </strong>{' '}
+                            <span style={{ color: '#333' }}>
+                              {greetingComment.comment}
+                            </span>
+                          </div>
+                        </div>
+                      </div>
+                    ))}
+
                   {/* Render cells sequentially with per-cell highlights */}
                   {state.cells.map((cell, idx) => {
                     if (cell.type === 'text') {
diff --git a/frontend/src/types/voice.ts b/frontend/src/types/voice.ts
index cee2487..d060c47 100644
--- a/frontend/src/types/voice.ts
+++ b/frontend/src/types/voice.ts
@@ -9,6 +9,7 @@ export interface VoiceConfig {
 export interface UserState {
   name: string;
   prompt: string;
+  greeting: string;
 }
 
 export interface StateConfig {
diff --git a/frontend/src/utils/voiceStorage.ts b/frontend/src/utils/voiceStorage.ts
index e1480e9..072a26b 100644
--- a/frontend/src/utils/voiceStorage.ts
+++ b/frontend/src/utils/voiceStorage.ts
@@ -10,15 +10,18 @@ const DEFAULT_STATE_CONFIG: StateConfig = {
   states: {
     happy: {
       name: "Happy",
-      prompt: "The user is feeling positive and energized. Encourage creative exploration and bold ideas."
+      prompt: "The user is feeling positive and energized. Encourage creative exploration and bold ideas.",
+      greeting: "Great to see you in high spirits! Let's capture this energy."
     },
     ok: {
       name: "OK",
-      prompt: "The user is feeling neutral. Provide balanced, steady guidance."
+      prompt: "The user is feeling neutral. Provide balanced, steady guidance.",
+      greeting: "Steady and ready. Let's see what today brings."
     },
     unhappy: {
       name: "Unhappy",
-      prompt: "The user is feeling down. Be gentle, supportive, and focus on small wins."
+      prompt: "The user is feeling down. Be gentle, supportive, and focus on small wins.",
+      greeting: "I'm here with you. Sometimes writing helps make sense of things."
     }
   }
 };
