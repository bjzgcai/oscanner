*** FILE: backend/database.py ***
@@ -144,6 +144,7 @@ def create_tables(db):
       parent_id TEXT,
       owner_id INTEGER,
       enabled BOOLEAN DEFAULT 1,
+      has_local_changes BOOLEAN DEFAULT 0,
       order_index INTEGER,
       created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
       updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
@@ -168,6 +169,7 @@ def create_tables(db):
       parent_id TEXT,
       owner_id INTEGER,
       enabled BOOLEAN DEFAULT 1,
+      has_local_changes BOOLEAN DEFAULT 0,
       order_index INTEGER,
       created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
       updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
@@ -196,11 +198,11 @@ def seed_system_decks():
 
     # ========== Deck 1: Introspection Deck ==========
     db.execute("""
-    INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en, icon, color, is_system, enabled, order_index)
-    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
+    INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en, icon, color, is_system, enabled, has_local_changes, order_index)
+    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
     """, ('introspection_deck', '内省卡组', '内省卡组', 'Introspection Deck',
           '内心对话原型', '内心对话原型', 'Inner dialogue archetypes',
-          'brain', 'purple', 1, 1, 0))
+          'brain', 'purple', 1, 1, 0, 0))
 
     # Import config to get existing voice prompts
     import config
@@ -223,17 +225,17 @@ def seed_system_decks():
 
     for voice_id, name, name_zh, name_en, prompt, icon, color, order in introspection_voices:
         db.execute("""
-        INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt, icon, color, is_system, enabled, order_index)
-        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
+        INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt, icon, color, is_system, enabled, has_local_changes, order_index)
+        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?)
         """, (voice_id, 'introspection_deck', name, name_zh, name_en, prompt, icon, color, 1, 1, order))
 
     # ========== Deck 2: Scholar Deck ==========
     db.execute("""
-    INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en, icon, color, is_system, enabled, order_index)
-    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
+    INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en, icon, color, is_system, enabled, has_local_changes, order_index)
+    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
     """, ('scholar_deck', '学者卡组', '学者卡组', 'Scholar Deck',
           '从学术角度分析思考', '从学术角度分析思考', 'Analyze from academic perspectives',
-          'lightbulb', 'blue', 1, 1, 1))
+          'lightbulb', 'blue', 1, 1, 0, 1))
 
     # Scholar voices (placeholder prompts - TODO: write detailed prompts)
     scholar_voices = [
@@ -253,17 +255,17 @@ def seed_system_decks():
 
     for voice_id, name, name_zh, name_en, prompt, icon, color, order in scholar_voices:
         db.execute("""
-        INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt, icon, color, is_system, enabled, order_index)
-        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
+        INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt, icon, color, is_system, enabled, has_local_changes, order_index)
+        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?)
         """, (voice_id, 'scholar_deck', name, name_zh, name_en, prompt, icon, color, 1, 1, order))
 
     # ========== Deck 3: Philosophy Deck ==========
     db.execute("""
-    INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en, icon, color, is_system, enabled, order_index)
-    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
+    INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en, icon, color, is_system, enabled, has_local_changes, order_index)
+    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
     """, ('philosophy_deck', '哲学卡组', '哲学卡组', 'Philosophy Deck',
           '不同哲学流派的审视', '不同哲学流派的审视', 'Examine through philosophical lenses',
-          'cloud', 'purple', 1, 1, 2))
+          'cloud', 'purple', 1, 1, 0, 2))
 
     # Philosophy voices (placeholder prompts - TODO: write detailed prompts)
     philosophy_voices = [
@@ -279,8 +281,8 @@ def seed_system_decks():
 
     for voice_id, name, name_zh, name_en, prompt, icon, color, order in philosophy_voices:
         db.execute("""
-        INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt, icon, color, is_system, enabled, order_index)
-        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
+        INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt, icon, color, is_system, enabled, has_local_changes, order_index)
+        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?)
         """, (voice_id, 'philosophy_deck', name, name_zh, name_en, prompt, icon, color, 1, 1, order))
 
     db.commit()
@@ -291,16 +293,18 @@ def seed_system_decks():
 
 def get_user_decks(user_id: int):
     """
-    Get all decks visible to user (system decks + user's own decks).
+    Get all user's own decks (forked from system templates).
     Returns list of deck dicts with voice counts.
+
+    @@@ Users only see their own forked copies, never system decks directly
     """
     db = get_db()
     try:
         rows = db.execute("""
         SELECT d.*, COUNT(v.id) as voice_count
         FROM decks d
         LEFT JOIN voices v ON d.id = v.deck_id AND v.enabled = 1
-        WHERE d.is_system = 1 OR d.owner_id = ?
+        WHERE d.owner_id = ?
         GROUP BY d.id
         ORDER BY d.order_index, d.created_at
         """, (user_id,)).fetchall()
@@ -311,14 +315,16 @@ def get_user_decks(user_id: int):
 def get_deck_with_voices(user_id: int, deck_id: str):
     """
     Get full deck details with all voices.
-    Returns None if deck doesn't exist or user doesn't have access.
+    Returns None if deck doesn't exist or user doesn't own it.
+
+    @@@ Users only access their own forked decks
     """
     db = get_db()
     try:
-        # Get deck
+        # Get deck (must be user's own)
         deck_row = db.execute("""
         SELECT * FROM decks
-        WHERE id = ? AND (is_system = 1 OR owner_id = ?)
+        WHERE id = ? AND owner_id = ?
         """, (deck_id, user_id)).fetchone()
 
         if not deck_row:
@@ -362,8 +368,8 @@ def create_deck(user_id: int, name: str, description: str = None,
 
         db.execute("""
         INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en,
-                          icon, color, is_system, owner_id, enabled, order_index)
-        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?, 1, ?)
+                          icon, color, is_system, owner_id, enabled, has_local_changes, order_index)
+        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?, 1, 0, ?)
         """, (deck_id, name, name_zh, name_en, description, description_zh, description_en,
               icon, color, user_id, order_index))
 
@@ -379,6 +385,9 @@ def update_deck(user_id: int, deck_id: str, updates: dict) -> bool:
 
     Updates dict can contain: name, name_zh, name_en, description, description_zh,
     description_en, icon, color, enabled, order_index
+
+    @@@ Content changes (name, description, icon, color) → has_local_changes = 1
+    @@@ Preference changes (enabled, order_index) → don't affect has_local_changes
     """
     db = get_db()
     try:
@@ -394,6 +403,8 @@ def update_deck(user_id: int, deck_id: str, updates: dict) -> bool:
         # Build update query
         allowed_fields = ['name', 'name_zh', 'name_en', 'description', 'description_zh',
                          'description_en', 'icon', 'color', 'enabled', 'order_index']
+        content_fields = ['name', 'name_zh', 'name_en', 'description', 'description_zh',
+                         'description_en', 'icon', 'color']
 
         update_fields = []
         params = []
@@ -405,6 +416,11 @@ def update_deck(user_id: int, deck_id: str, updates: dict) -> bool:
         if not update_fields:
             return True  # No updates
 
+        # @@@ Mark as locally changed if content fields are modified
+        has_content_change = any(field in updates for field in content_fields)
+        if has_content_change:
+            update_fields.append("has_local_changes = 1")
+
         update_fields.append("updated_at = CURRENT_TIMESTAMP")
         params.append(deck_id)
 
@@ -440,9 +456,30 @@ def delete_deck(user_id: int, deck_id: str) -> bool:
     finally:
         db.close()
 
+def auto_fork_system_decks(user_id: int):
+    """
+    Auto-fork all system decks for a new user.
+    Called on user registration/first login.
+    """
+    # @@@ Get deck list then close connection BEFORE forking (avoid deadlock)
+    db = get_db()
+    try:
+        system_decks = db.execute(
+            "SELECT id FROM decks WHERE is_system = 1 ORDER BY order_index"
+        ).fetchall()
+        deck_ids = [deck['id'] for deck in system_decks]
+    finally:
+        db.close()
+
+    # Fork each deck (each fork opens its own connection)
+    for deck_id in deck_ids:
+        fork_deck(user_id, deck_id)
+
+    print(f"✅ Auto-forked {len(deck_ids)} system decks for user {user_id}")
+
 def fork_deck(user_id: int, deck_id: str) -> str:
     """
-    Fork a deck (usually system deck) to create user's own copy.
+    Fork a deck to create user's own copy.
     Copies deck + all voices. Returns new deck_id.
     """
     import uuid
@@ -457,11 +494,11 @@ def fork_deck(user_id: int, deck_id: str) -> str:
         # Create new deck ID
         new_deck_id = str(uuid.uuid4())
 
-        # Copy deck
+        # Copy deck (has_local_changes = 0 initially, synced with parent)
         db.execute("""
         INSERT INTO decks (id, name, name_zh, name_en, description, description_zh, description_en,
-                          icon, color, is_system, parent_id, owner_id, enabled, order_index)
-        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, 1, ?)
+                          icon, color, is_system, parent_id, owner_id, enabled, has_local_changes, order_index)
+        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, 1, 0, ?)
         """, (new_deck_id,
               source_deck['name'],
               source_deck['name_zh'],
@@ -485,8 +522,8 @@ def fork_deck(user_id: int, deck_id: str) -> str:
             new_voice_id = str(uuid.uuid4())
             db.execute("""
             INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt,
-                              icon, color, is_system, parent_id, owner_id, enabled, order_index)
-            VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, 1, ?)
+                              icon, color, is_system, parent_id, owner_id, enabled, has_local_changes, order_index)
+            VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, 1, 0, ?)
             """, (new_voice_id,
                   new_deck_id,
                   voice['name'],
@@ -539,8 +576,8 @@ def create_voice(user_id: int, deck_id: str, name: str, system_prompt: str,
 
         db.execute("""
         INSERT INTO voices (id, deck_id, name, name_zh, name_en, system_prompt,
-                           icon, color, is_system, owner_id, enabled, order_index)
-        VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, 1, ?)
+                           icon, color, is_system, owner_id, enabled, has_local_changes, order_index)
+        VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, 1, 0, ?)
         """, (voice_id, deck_id, name, name_zh, name_en, system_prompt,
               icon, color, user_id, order_index))
 
@@ -556,6 +593,9 @@ def update_voice(user_id: int, voice_id: str, updates: dict) -> bool:
 
     Updates dict can contain: name, name_zh, name_en, system_prompt,
     icon, color, enabled, order_index
+
+    @@@ Content changes (name, system_prompt, icon, color) → has_local_changes = 1
+    @@@ Preference changes (enabled, order_index) → don't affect has_local_changes
     """
     db = get_db()
     try:
@@ -571,6 +611,8 @@ def update_voice(user_id: int, voice_id: str, updates: dict) -> bool:
         # Build update query
         allowed_fields = ['name', 'name_zh', 'name_en', 'system_prompt',
                          'icon', 'color', 'enabled', 'order_index']
+        content_fields = ['name', 'name_zh', 'name_en', 'system_prompt',
+                         'icon', 'color']
 
         update_fields = []
         params = []
@@ -582,6 +624,11 @@ def update_voice(user_id: int, voice_id: str, updates: dict) -> bool:
         if not update_fields:
             return True  # No updates
 
+        # @@@ Mark as locally changed if content fields are modified
+        has_content_change = any(field in updates for field in content_fields)
+        if has_content_change:
+            update_fields.append("has_local_changes = 1")
+
         update_fields.append("updated_at = CURRENT_TIMESTAMP")
         params.append(voice_id)
 

*** FILE: backend/server.py ***
@@ -739,6 +739,9 @@ def register(request: RegisterRequest):
     except ValueError as e:
         raise HTTPException(status_code=400, detail=str(e))
 
+    # @@@ Auto-fork all system decks for new user
+    database.auto_fork_system_decks(user_id)
+
     # Generate token
     token = auth.create_access_token(user_id, request.email)
 
@@ -767,6 +770,11 @@ def login(request: LoginRequest):
     if not auth.verify_password(request.password, user['password_hash']):
         raise HTTPException(status_code=401, detail="Invalid email or password")
 
+    # @@@ Auto-fork system decks if user has no decks yet (handles existing users)
+    user_decks = database.get_user_decks(user['id'])
+    if len(user_decks) == 0:
+        database.auto_fork_system_decks(user['id'])
+
     # Generate token
     token = auth.create_access_token(user['id'], user['email'])
 

*** FILE: frontend/src/App.tsx ***
@@ -2311,9 +2311,17 @@ export default function App() {
           display: 'flex',
           overflow: 'hidden'
         }}>
-          <DeckManager onUpdate={() => {
-            // Reload voice configs when decks/voices are updated
-            console.log('Deck system updated, reloading...');
+          <DeckManager onUpdate={async () => {
+            // @@@ Reload voice configs from deck system
+            console.log('Deck system updated, reloading voices...');
+            const updatedVoices = await loadVoicesFromDecks();
+            setVoiceConfigs(updatedVoices);
+
+            if (engineRef.current) {
+              engineRef.current.setVoiceConfigs(updatedVoices);
+            }
+
+            console.log(`✅ Loaded ${Object.keys(updatedVoices).length} enabled voices`);
           }} />
         </div>
       )}

*** FILE: frontend/src/components/DeckManager.tsx ***
@@ -124,6 +124,16 @@ export default function DeckManager({ onUpdate }: Props) {
     }
   }
 
+  async function handleToggleDeck(deckId: string, currentEnabled: boolean) {
+    try {
+      await updateDeck(deckId, { enabled: !currentEnabled });
+      await loadDecks();
+      onUpdate?.();
+    } catch (err: any) {
+      alert(`Failed to toggle deck: ${err.message}`);
+    }
+  }
+
   async function handleDeleteDeck(deckId: string) {
     if (!confirm('Delete this deck and all its voices?')) return;
 
@@ -136,6 +146,16 @@ export default function DeckManager({ onUpdate }: Props) {
     }
   }
 
+  async function handleToggleVoice(voiceId: string, currentEnabled: boolean) {
+    try {
+      await updateVoice(voiceId, { enabled: !currentEnabled });
+      await loadDecks();
+      onUpdate?.();
+    } catch (err: any) {
+      alert(`Failed to toggle voice: ${err.message}`);
+    }
+  }
+
   async function handleUpdateVoice(voiceId: string, data: Partial<Voice>) {
     try {
       await updateVoice(voiceId, data);
@@ -331,7 +351,35 @@ export default function DeckManager({ onUpdate }: Props) {
                   </div>
 
                   {/* Actions */}
-                  <div style={{ display: 'flex', gap: 8 }} onClick={(e) => e.stopPropagation()}>
+                  <div style={{ display: 'flex', alignItems: 'center', gap: 12 }} onClick={(e) => e.stopPropagation()}>
+                    {/* @@@ Deck-level toggle switch */}
+                    <div
+                      onClick={() => handleToggleDeck(deck.id, deck.enabled)}
+                      style={{
+                        width: 50,
+                        height: 26,
+                        borderRadius: 13,
+                        background: deck.enabled ? colorHex : '#ccc',
+                        position: 'relative',
+                        cursor: 'pointer',
+                        transition: 'background 0.3s',
+                        flexShrink: 0
+                      }}
+                      title={deck.enabled ? 'Disable deck' : 'Enable deck'}
+                    >
+                      <div style={{
+                        position: 'absolute',
+                        top: 3,
+                        left: deck.enabled ? 26 : 3,
+                        width: 20,
+                        height: 20,
+                        borderRadius: 10,
+                        background: '#fff',
+                        transition: 'left 0.3s',
+                        boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
+                      }} />
+                    </div>
+
                     {isSystem ? (
                       <button
                         onClick={() => handleForkDeck(deck.id)}
@@ -442,6 +490,34 @@ export default function DeckManager({ onUpdate }: Props) {
                                 </div>
                               </div>
 
+                              {/* @@@ Voice-level toggle switch */}
+                              <div
+                                onClick={() => handleToggleVoice(voice.id, voice.enabled)}
+                                style={{
+                                  width: 40,
+                                  height: 22,
+                                  borderRadius: 11,
+                                  background: voice.enabled ? voiceColor : '#ccc',
+                                  position: 'relative',
+                                  cursor: 'pointer',
+                                  transition: 'background 0.3s',
+                                  flexShrink: 0
+                                }}
+                                title={voice.enabled ? 'Disable voice' : 'Enable voice'}
+                              >
+                                <div style={{
+                                  position: 'absolute',
+                                  top: 3,
+                                  left: voice.enabled ? 21 : 3,
+                                  width: 16,
+                                  height: 16,
+                                  borderRadius: 8,
+                                  background: '#fff',
+                                  transition: 'left 0.3s',
+                                  boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
+                                }} />
+                              </div>
+
                               {!isSystem && (
                                 <button
                                   onClick={() => handleDeleteVoice(voice.id)}
